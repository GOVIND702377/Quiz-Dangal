import{c as x,u as z,a as b,b as q,r,s as f,j as e,S as k,T as N,m as _}from"./index-3d4d01e5.js";const M=x("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),S=x("Clapperboard",[["path",{d:"M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z",key:"1tn4o7"}],["path",{d:"m6.2 5.3 3.1 3.9",key:"iuk76l"}],["path",{d:"m12.4 3.4 3.1 4",key:"6hsd6n"}],["path",{d:"M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z",key:"ltgou9"}]]),C=x("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),E=[{title:"Opinion",slug:"opinion",icon:C},{title:"G.K Knowledge",slug:"gk",icon:M},{title:"Sports",slug:"sports",icon:N},{title:"Movies",slug:"movies",icon:S}],A=a=>["1","2","3","4"][a%4],T=({tile:a,quizzes:c,onJoin:o,index:d})=>{const n=c.find(l=>(l.category||"").toLowerCase()===a.slug.toLowerCase()),u=a.icon;return e.jsx(_.button,{type:"button",initial:{opacity:0},animate:{opacity:1},transition:{duration:.25,delay:d*.05},onClick:()=>n&&o(n),className:`qd-tile tile-vivid-${A(d)} group aspect-square w-full focus:outline-none will-change-transform transform-gpu`,children:e.jsxs("div",{className:"qd-tile-inner",children:[e.jsxs("div",{className:"flex items-start justify-between w-full",children:[e.jsx("div",{className:"qd-tile-icon",children:e.jsx(u,{className:"w-7 h-7 drop-shadow text-white/95"})}),e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] font-semibold bg-white/20 text-white shadow-sm border border-white/30",children:"PLAY"})]}),e.jsx("div",{className:"select-none",children:e.jsx("h3",{className:"font-extrabold text-base leading-tight text-shadow-sm text-white",children:a.title})})]})})},I=()=>{const{toast:a}=z(),c=b(),{user:o,userProfile:d,refreshUserProfile:n}=q(),[u,l]=r.useState([]),[v,w]=r.useState(!0),[h,g]=r.useState({open:!1,day:0,coins:0}),p=r.useRef(!1),m=r.useCallback(async()=>{try{const{data:t,error:s}=await f.from("quizzes").select("*").order("start_time",{ascending:!0});if(s)throw s;l(t||[])}catch(t){console.error(t),a({title:"Error",description:"Could not fetch quizzes.",variant:"destructive"}),l([])}finally{w(!1)}},[a]);r.useEffect(()=>{m();const t=setInterval(m,3e4);return()=>clearInterval(t)},[m]),r.useEffect(()=>{if(!o||p.current)return;const s=setTimeout(async()=>{p.current=!0;try{const{data:i,error:y}=await f.rpc("handle_daily_login",{user_uuid:o.id});if(y)return console.error(y);i&&i.is_new_login&&(await n(o),g({open:!0,day:i.streak_day,coins:i.coins_earned}))}finally{p.current=!1}},1200);return()=>clearTimeout(s)},[o,n]);const j=async t=>{try{const{data:s,error:i}=await f.rpc("join_quiz",{p_quiz_id:t.id});if(i)throw i;if(s&&s!=="Joined Successfully")throw new Error(s);a({title:"Joined!",description:"Redirecting you to the quiz."}),c(`/quiz/${t.id}`)}catch(s){a({title:"Error",description:s.message||"Could not join quiz.",variant:"destructive"})}};return e.jsxs("div",{className:"h-full relative overflow-hidden",children:[e.jsx("div",{className:"relative z-10 h-full flex items-center justify-center px-4 mt-1 sm:mt-2",children:e.jsx("div",{className:"w-full max-w-[420px]",children:e.jsx("div",{className:"qd-card rounded-3xl shadow-2xl p-3",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:v?Array.from({length:4}).map((t,s)=>e.jsx("div",{className:"aspect-square w-full rounded-2xl bg-slate-800/60 border border-slate-700/60 animate-pulse"},s)):E.map((t,s)=>e.jsx(T,{tile:t,quizzes:u,onJoin:j,index:s},t.slug))})})})}),e.jsx(k,{open:h.open,day:h.day,coins:h.coins,onClose:()=>g(t=>({...t,open:!1}))})]})};export{I as default};
