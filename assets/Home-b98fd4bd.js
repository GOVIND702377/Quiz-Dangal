import{u as j,a as b,s as y,j as t,S as q}from"./index-4e80050d.js";import{r as c}from"./react-8a702e3e.js";import{S as _}from"./SEO-cd8a3ee6.js";import{a as N}from"./router-f2cf3f51.js";import{m as z}from"./motion-f69b6c08.js";import{a as S,B as k,T as C,b as D}from"./icons-71504e08.js";import"./supabase-4c1332f7.js";const E=[{title:"Opinion",slug:"opinion",icon:S},{title:"G.K Knowledge",slug:"gk",icon:k},{title:"Sports",slug:"sports",icon:C},{title:"Movies",slug:"movies",icon:D}],I=({tile:n,quizzes:d,index:g,navigateTo:x})=>{const l=Date.now();d.filter(s=>(s.category||"").toLowerCase()===n.slug.toLowerCase()).filter(s=>{const a=s.start_time?new Date(s.start_time).getTime():0,p=s.end_time?new Date(s.end_time).getTime():0,m=a&&p&&l>=a&&l<p,v=a&&l<a;return m||v}).sort((s,a)=>new Date(s.start_time||s.end_time||0)-new Date(a.start_time||a.end_time||0));const w=n.icon,f=["neon-orange","neon-purple","neon-teal","neon-pink"],u="PLAY";return t.jsx(z.button,{type:"button",initial:{opacity:0,scale:.96},animate:{opacity:1,scale:1},transition:{duration:.25,delay:g*.06},onClick:()=>x(n.slug),className:`neon-card ${f[g%f.length]} group aspect-square w-full rounded-xl focus:outline-none will-change-transform transform-gpu transition-transform hover:scale-[1.02] hover:shadow-xl relative`,style:{borderRadius:"0.75rem"},"aria-label":`${n.title} - Play`,children:t.jsx("div",{className:"neon-card-content select-none flex items-center justify-center",children:t.jsxs("div",{className:"w-full flex flex-col items-center justify-center gap-2",children:[t.jsx(w,{className:"w-8 h-8 text-white drop-shadow"}),t.jsx("h3",{className:"text-base font-extrabold leading-tight text-white text-shadow-sm text-center",children:n.title}),t.jsx("span",{className:"play-pill group-hover:shadow-lg group-hover:brightness-110",children:u})]})})})},R=()=>{const{toast:n}=j(),d=N(),{user:g}=b(),[x,l]=c.useState([]),[w,f]=c.useState(!0),[u,s]=c.useState({open:!1,day:0,coins:0}),[a,p]=c.useState(null),m=c.useCallback(async()=>{try{const{data:e,error:i}=await y.from("quizzes").select("id,title,category,start_time,end_time,status,prize_pool,prizes").order("start_time",{ascending:!0});if(i)throw i;l(e||[])}catch(e){console.error(e),n({title:"Error",description:"Could not fetch quizzes.",variant:"destructive"}),l([])}finally{f(!1)}},[n]);c.useEffect(()=>{m();const e=setInterval(m,6e4);return()=>clearInterval(e)},[m]);const v=async e=>{if(!(!e||a===e.id)){if(!g){n({title:"Login required",description:"Please sign in to join the quiz.",variant:"destructive"}),d("/login");return}p(e.id);try{const i=e.status==="upcoming"?"pre_join_quiz":"join_quiz",{data:o,error:r}=await y.rpc(i,{p_quiz_id:e.id});if(r)throw r;if(e.status==="upcoming")n({title:"Pre-joined!",description:"We will remind you 1 minute before start."});else{if(o&&o!=="Joined Successfully")throw new Error(o);n({title:"Joined!",description:"Redirecting you to the quiz."}),d(`/quiz/${e.id}`)}}catch(i){const o=String((i==null?void 0:i.message)||"").toLowerCase();let r=(i==null?void 0:i.message)||"Could not join quiz.",h="Error";o.includes("not authenticated")?(h="Login required",r="Please sign in to join the quiz."):o.includes("insufficient balance")?(h="Insufficient balance",r="You do not have enough coins to join this quiz."):o.includes("quiz not active")&&(h="Quiz not active",r="This quiz is not active right now."),n({title:h,description:r,variant:"destructive"})}finally{p(null)}}};return t.jsxs("div",{className:"h-full relative overflow-hidden",children:[t.jsx(_,{title:"Quiz Dangal – Play Quiz & Win Rewards | Opinion, GK, Sports, Movies",description:"Play daily opinion-based quizzes on Quiz Dangal. Win coins, climb leaderboards, and refer & earn with friends. India’s top play & win quiz app.",canonical:"https://quizdangal.com/",keywords:["Quiz Dangal","quizdangal","quiz app","play quiz and win","opinion quiz","daily quiz India","refer and earn quiz","win rewards","leaderboards","online quiz contest"]}),t.jsx("div",{className:"relative z-10 h-full flex items-center justify-center px-4 mt-1 sm:mt-2 mb-6",children:t.jsxs("div",{className:"w-full max-w-[420px]",children:[t.jsxs(z.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.25},className:"text-center mb-4",children:[t.jsx("h1",{className:"text-xl font-extrabold tracking-tight bg-gradient-to-r from-indigo-200 via-fuchsia-200 to-pink-200 bg-clip-text text-transparent",children:"Brain games, real gains. Ready to shine?"}),t.jsx("p",{className:"text-[13px] text-slate-300/90 mt-1",children:"Compete, earn, repeat — where winners never chill out."}),t.jsx("div",{className:"mx-auto mt-2 h-[2px] w-24 rounded-full bg-gradient-to-r from-indigo-400/60 via-fuchsia-400/60 to-pink-400/60"})]}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:w?Array.from({length:4}).map((e,i)=>t.jsx("div",{className:"aspect-square w-full rounded-xl bg-slate-800/60 border border-slate-700/60 animate-pulse"},i)):E.map((e,i)=>t.jsx(I,{tile:e,quizzes:x,onJoin:v,index:i,joiningId:a,navigateTo:o=>d(`/category/${o}`)},e.slug))})]})}),t.jsx(q,{open:u.open,day:u.day,coins:u.coins,onClose:()=>s(e=>({...e,open:!1}))})]})};export{R as default};
