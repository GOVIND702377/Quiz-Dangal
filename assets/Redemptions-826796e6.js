import{a as xe,u as ue,h as y,s as g,j as e,m as b,D as he,p as pe,q as ge,r as be,t as fe,v as ve,B as K,A as we}from"./index-93d743b2.js";import{r as n,a as je}from"./react-8a702e3e.js";import{a3 as Ne,S as ye,G as B,C as Q,a4 as _e,a5 as ke,a6 as Se,L as Ce,a7 as X,e as J,a8 as Re}from"./icons-e9c8901f.js";import"./supabase-4c1332f7.js";import"./router-f2cf3f51.js";function Le(){const{user:h,userProfile:p,refreshUserProfile:F}=xe(),{toast:x}=ue(),[u,j]=n.useState([]),[Z,_]=n.useState(!0),[ee,q]=n.useState([]),[te,I]=n.useState(!0),[c,V]=n.useState(null),[se,P]=n.useState(!1),[O,D]=n.useState("confirm"),[W,L]=n.useState(!1),[M,N]=n.useState(""),[f,k]=n.useState("upi"),[H,Y]=n.useState("cash"),E=je.useRef(null),[ae,v]=n.useState(!1),re=typeof window!="undefined"&&/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent||""),[S,ie]=n.useState("rewards"),G="",ne="newest",T=n.useCallback(t=>{var r,l,a;if(!t)return"";const s=(a=(l=(r=t.reward_value)!=null?r:t.value)!=null?l:t.amount)!=null?a:"";return s==null?"":String(s).trim()},[]),le=n.useCallback(t=>t==null?"":String(t).trim(),[]),U=n.useCallback(async()=>{if(!h||!y||!g){j([]),_(!1);return}_(!0);try{const{data:t,error:s}=await g.from("redemptions").select("*").eq("user_id",h.id).order("requested_at",{ascending:!1});if(s){console.error("Failed to fetch redemptions history",s),j([]);return}j(t||[])}catch(t){console.error("Unexpected error while fetching redemptions history",t),j([])}finally{_(!1)}},[h]);n.useEffect(()=>{if(!h||!y||!g){j([]),_(!1);return}const t=async()=>{await U()};t();const s=setInterval(t,15e3);return()=>{clearInterval(s)}},[h,U]),n.useEffect(()=>{async function t(){if(!y||!g){q([]),I(!1);return}I(!0);const s=await g.from("reward_catalog").select("*").eq("is_active",!0).order("coins_required",{ascending:!0}).order("id",{ascending:!1});s.error?q([]):q(s.data||[]),I(!1)}t()},[]);const $=n.useMemo(()=>Number((p==null?void 0:p.wallet_balance)||0),[p]),C=ee||[],z=n.useMemo(()=>{const t=G.trim().toLowerCase();let s=u||[];return t&&(s=s.filter(r=>String(r.reward_type||"").toLowerCase().includes(t)||String(r.reward_value||"").toLowerCase().includes(t)||String(r.status||"").toLowerCase().includes(t))),s=[...s].sort((r,l)=>{const a=r.requested_at?new Date(r.requested_at).getTime():0;return(l.requested_at?new Date(l.requested_at).getTime():0)-a}),s},[u,G,ne]),oe=n.useCallback(t=>{const s=String((t==null?void 0:t.reward_type)||"").trim().toLowerCase();return!s||s.includes("cash")?"cash":s.includes("voucher")||s==="voucher"?"voucher":"cash"},[]),R=n.useMemo(()=>{const t=u.length,s=u.filter(i=>i.status==="pending").length,r=u.filter(i=>i.status==="approved").length,l=u.filter(i=>i.status==="rejected").length,a=u.reduce((i,o)=>i+Number(o.coins_required||0),0);return{total:t,pending:s,approved:r,rejected:l,coinsUsed:a}},[u]),de=t=>{const s=String(t||"").toLowerCase();return s==="approved"?{label:"Approved",className:"bg-emerald-500/15 text-emerald-300 border-emerald-400/30",icon:X,rowAccent:"border-l-2 border-emerald-400/60"}:s==="pending"?{label:"Pending",className:"bg-amber-500/15 text-amber-200 border-amber-300/30",icon:J,rowAccent:"border-l-2 border-amber-400/60"}:s==="rejected"?{label:"Rejected",className:"bg-rose-500/15 text-rose-200 border-rose-300/30",icon:Re,rowAccent:"border-l-2 border-rose-400/60"}:{label:"Unknown",className:"bg-slate-500/15 text-slate-200 border-slate-300/30",icon:J,rowAccent:"border-l-2 border-slate-400/50"}},ce=t=>{const s=oe(t);V(t),Y(s),D("confirm"),N(""),v(!1),k(s==="voucher"?"phone":"upi"),P(!0),setTimeout(()=>{var r;try{(r=E.current)==null||r.focus()}catch(l){}},100)},me=async()=>{var a,i,o,m;if(!c||!h)return;if(!y||!g){x({title:"Configuration missing",description:"Supabase env vars are not set. Please configure .env.local",variant:"destructive"});return}const t=H==="voucher",s=Number((o=(i=(a=c.coins_required)!=null?a:c.coin_cost)!=null?i:c.coins)!=null?o:0),r=M.trim();if(((m=p==null?void 0:p.wallet_balance)!=null?m:0)<s){x({title:"Not enough coins",description:"Earn more coins to redeem this reward."});return}if(!r){x({title:"Enter payout details",description:t?"Please provide your WhatsApp number.":"Please provide your UPI ID or phone number."});return}let l=r;if(t){const d=r.replace(/\D/g,"");if(d.length<8||d.length>15){x({title:"Invalid WhatsApp number",description:"Please enter a valid WhatsApp number with 8 to 15 digits.",variant:"destructive"});return}l=d}try{L(!0);const d=t?"phone":f||"upi";t&&f!=="phone"&&k("phone");const w={p_catalog_id:c.id,p_payout_identifier:l,p_payout_channel:d};let{error:A}=await g.rpc("redeem_from_catalog_with_details",w);if(A)throw A;D("success"),x({title:"Redemption pending",description:"Your request is submitted. Await admin approval."}),N(""),await U(),typeof F=="function"&&await F(h).catch(()=>{})}catch(d){const w=(d==null?void 0:d.message)||"Please try again later";x({title:"Submission failed",description:w,variant:"destructive"})}finally{L(!1)}};return e.jsxs("div",{className:"relative mx-auto max-w-5xl px-4 py-6",children:[e.jsx("div",{className:"absolute inset-0 -z-10 opacity-70 mix-blend-screen [background-image:radial-gradient(circle_at_18%_28%,rgba(56,189,248,0.25),rgba(0,0,0,0)60%),radial-gradient(circle_at_82%_72%,rgba(192,132,252,0.22),rgba(0,0,0,0)65%),radial-gradient(circle_at_50%_50%,rgba(244,114,182,0.15),rgba(0,0,0,0)55%)]"}),e.jsx("div",{className:"mb-6",children:e.jsxs(b.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.45},className:"flex items-center gap-3",children:[e.jsx(b.div,{className:"w-10 h-10 rounded-2xl bg-gradient-to-br from-indigo-500 to-fuchsia-500 grid place-items-center ring-2 ring-white/30 shadow-xl",animate:{y:[0,-2,0]},transition:{repeat:1/0,duration:4,ease:"easeInOut"},children:e.jsx(Ne,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold bg-gradient-to-r from-indigo-200 via-fuchsia-200 to-pink-200 bg-clip-text text-transparent tracking-tight",children:"Redemptions"}),e.jsx("div",{className:"mt-0.5 h-[2px] w-24 bg-gradient-to-r from-indigo-400/60 via-fuchsia-400/60 to-pink-400/60 rounded-full"}),e.jsx("p",{className:"text-slate-300/80 text-sm mt-1",children:"Track your reward requests"})]})]})}),!y&&e.jsx("div",{className:"mb-4 rounded-xl border border-amber-300/30 bg-amber-500/10 p-3 text-amber-100 text-sm",children:"Supabase configuration missing. Create a .env.local file with VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY to enable redemptions and history."}),e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[[{key:"rewards",label:"Rewards"},{key:"history",label:"History"}].map(t=>e.jsx("button",{onClick:()=>ie(t.key),className:`px-3 py-1.5 rounded-xl text-xs font-semibold border transition ${S===t.key?"bg-white/10 text-white border-white/20 shadow hover:bg-white/15":"bg-white/5 text-slate-200/90 border-white/10 hover:bg-white/10 hover:border-white/20"}`,children:t.label},t.key)),e.jsx("div",{className:"ml-auto"})]}),S==="rewards"&&e.jsx(b.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"relative rounded-3xl p-[1px] bg-[radial-gradient(1200px_600px_at_10%_-10%,rgba(99,102,241,0.25),transparent_60%),radial-gradient(1200px_600px_at_90%_110%,rgba(217,70,239,0.22),transparent_60%)] mb-6",children:e.jsxs("div",{className:"qd-card rounded-3xl p-5 shadow-xl border border-white/10 bg-white/[0.03] backdrop-blur-xl",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"inline-flex w-9 h-9 rounded-xl bg-gradient-to-br from-fuchsia-500/25 to-indigo-500/25 border border-white/10 items-center justify-center",children:e.jsx(ye,{className:"w-4.5 h-4.5 text-fuchsia-200"})}),e.jsx("h2",{className:"text-lg md:text-xl font-bold text-slate-100",children:"Available Rewards"})]}),te?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[...Array(6)].map((t,s)=>e.jsx("div",{className:"rounded-2xl p-[1px] bg-gradient-to-br from-indigo-500/30 via-fuchsia-500/20 to-violet-500/30",children:e.jsx("div",{className:"rounded-2xl p-3 bg-slate-900/50 border border-white/10",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-24 rounded-xl bg-slate-700/40"}),e.jsx("div",{className:"h-3 rounded bg-slate-700/40 w-3/4"}),e.jsx("div",{className:"h-2.5 rounded bg-slate-700/40 w-1/2"}),e.jsx("div",{className:"h-8 rounded-lg bg-slate-700/40 w-full"})]})})},s))}):((C==null?void 0:C.length)||0)===0?e.jsx("div",{className:"text-center py-8 text-slate-300",children:"No rewards found. Try a different search or filter."}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:C.map(t=>{var m,d,w;const s=Number((w=(d=(m=t.coins_required)!=null?m:t.coin_cost)!=null?d:t.coins)!=null?w:0),r=T(t),l=le(r),a=$>=s,i=s>0?Math.min(100,Math.max(0,Math.round($/s*100))):100,o=t.description?String(t.description).trim():"";return e.jsxs(b.div,{className:"group relative flex h-full flex-col overflow-hidden rounded-3xl border border-white/10 bg-[linear-gradient(160deg,rgba(31,41,80,0.92),rgba(11,15,34,0.96))] shadow-[0_25px_45px_-35px_rgba(129,140,248,0.9)] backdrop-blur-xl",whileHover:{y:-4,scale:1.015},transition:{type:"spring",stiffness:260,damping:22},children:[e.jsxs("div",{className:"relative aspect-[4/5] w-full overflow-hidden sm:aspect-[4/4.5]",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:t.title||"Reward preview",className:"absolute inset-0 h-full w-full object-cover transition-transform duration-500 group-hover:scale-105",onError:A=>{A.currentTarget.style.display="none"}}):e.jsx("div",{className:"absolute inset-0 grid place-items-center bg-gradient-to-br from-indigo-500/40 via-fuchsia-500/30 to-sky-500/25",children:e.jsx("div",{className:"grid place-items-center rounded-2xl bg-black/30 p-6 pt-7 shadow-lg ring-1 ring-white/12",children:e.jsx(B,{className:"h-11 w-11 text-white/95 translate-y-1"})})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950/85 via-slate-950/20 to-transparent"}),e.jsxs("div",{className:"relative flex h-full flex-col items-center justify-end gap-2 p-4 pb-12 text-center",children:[l&&e.jsx("div",{className:"pointer-events-none absolute left-1/2 -translate-x-1/2 bottom-3",children:e.jsx("div",{className:"inline-flex w-[94%] sm:w-[90%] items-center justify-center rounded-2xl border border-white/20 bg-gradient-to-r from-white/15 to-white/10 px-5 py-2 text-white shadow-[0_8px_24px_rgba(0,0,0,0.35)] backdrop-blur-md ring-1 ring-white/10",title:l,children:e.jsx("span",{className:"text-[clamp(0.9rem,2.5vw,1.125rem)] font-semibold tracking-tight leading-none whitespace-nowrap",children:l})})}),t.title&&e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-100/80 sm:text-sm sm:normal-case sm:tracking-normal sm:text-slate-100/90",children:t.title})]})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-3 p-4",children:[o&&e.jsx("p",{className:"text-xs leading-relaxed text-slate-300/85",children:o.length>140?`${o.slice(0,137)}...`:o}),e.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-white/12 bg-[radial-gradient(circle_at_top,rgba(79,70,229,0.42),rgba(12,15,35,0.92))] px-3.5 py-3 shadow-[0_18px_34px_-26px_rgba(129,140,248,0.75)] backdrop-blur",children:[e.jsx("div",{className:"inline-flex h-9 w-9 flex-shrink-0 items-center justify-center rounded-2xl bg-white/12 text-indigo-100 ring-1 ring-white/35 shadow-inner",children:e.jsx(Q,{className:"h-3.5 w-3.5"})}),e.jsxs("div",{className:"leading-tight text-left text-white",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-[0.25em] text-white/70",children:"Coins needed"}),e.jsx("div",{className:"text-base font-semibold tracking-tight text-white",children:s.toLocaleString()})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"h-1.5 w-full overflow-hidden rounded-full bg-white/15",children:e.jsx("div",{className:"h-full rounded-full bg-[linear-gradient(90deg,#38bdf8,#a855f7,#f472b6)] shadow-[0_0_12px_rgba(168,85,247,0.45)] transition-all duration-500",style:{width:`${i}%`}})})}),e.jsx("div",{className:"mt-auto",children:e.jsxs("button",{type:"button",disabled:!a,onClick:()=>ce(t),className:`w-full inline-flex items-center justify-center gap-2 rounded-2xl px-3 py-2.5 text-sm font-semibold transition focus:outline-none focus:ring-2 focus:ring-indigo-400/40 ${a?"bg-gradient-to-r from-indigo-600 to-fuchsia-600 text-white shadow-lg hover:from-indigo-500 hover:to-fuchsia-500":"bg-white/5 text-slate-300/70 border border-white/10 cursor-not-allowed"}`,title:a?"Redeem reward":"Not enough coins yet",children:["Redeem ",e.jsx(_e,{className:"h-4 w-4"})]})})]})]},t.id)})})]})}),S==="rewards"&&e.jsxs("div",{className:"rounded-3xl p-5 md:p-6 bg-white/[0.035] backdrop-blur-xl border border-white/10 shadow-2xl mb-6 relative overflow-hidden",children:[e.jsx("div",{className:"pointer-events-none absolute -inset-px opacity-[0.06] bg-[radial-gradient(600px_200px_at_10%_-20%,#6366f1,transparent),radial-gradient(500px_200px_at_90%_120%,#e879f9,transparent)]"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"rounded-2xl p-3.5 bg-indigo-500/10 border border-indigo-300/25",children:[e.jsx("div",{className:"text-[11px] font-semibold text-indigo-200/90",children:"Total Requests"}),e.jsx("div",{className:"mt-1 text-xl font-extrabold text-indigo-200",children:R.total})]}),e.jsxs("div",{className:"rounded-2xl p-3.5 bg-amber-500/10 border border-amber-300/25",children:[e.jsx("div",{className:"text-[11px] font-semibold text-amber-200/90",children:"Pending"}),e.jsx("div",{className:"mt-1 text-xl font-extrabold text-amber-200",children:R.pending})]}),e.jsxs("div",{className:"rounded-2xl p-3.5 bg-emerald-500/10 border border-emerald-300/25",children:[e.jsx("div",{className:"text-[11px] font-semibold text-emerald-200/90",children:"Approved"}),e.jsx("div",{className:"mt-1 text-xl font-extrabold text-emerald-200",children:R.approved})]}),e.jsxs("div",{className:"rounded-2xl p-3.5 bg-fuchsia-500/10 border border-fuchsia-300/25",children:[e.jsxs("div",{className:"text-[11px] font-semibold text-fuchsia-200/90 inline-flex items-center gap-1",children:[e.jsx(Q,{className:"w-3.5 h-3.5"})," Coins Used"]}),e.jsx("div",{className:"mt-1 text-xl font-extrabold text-fuchsia-200",children:Number(R.coinsUsed||0).toLocaleString()})]})]})]}),S==="history"&&e.jsx("div",{className:"qd-card rounded-3xl p-5 shadow-xl border border-white/10 bg-white/[0.02] backdrop-blur-xl",children:Z?e.jsx("div",{className:"space-y-3",children:[...Array(4)].map((t,s)=>e.jsx("div",{className:"p-3 rounded-xl bg-indigo-900/30 border border-indigo-700/40",children:e.jsxs("div",{className:"animate-pulse flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 w-2/3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-800/40"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 bg-indigo-800/40 rounded w-2/3 mb-2"}),e.jsx("div",{className:"h-2.5 bg-indigo-800/40 rounded w-1/3"})]})]}),e.jsx("div",{className:"h-3 w-20 bg-indigo-800/40 rounded"})]})},s))}):z.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 rounded-2xl bg-gradient-to-br from-indigo-500 to-fuchsia-500 text-white shadow-md mb-3",children:e.jsx(B,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-slate-200 font-semibold",children:"No redemptions yet"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Make a request and it will appear here."})]}):e.jsx("div",{className:"space-y-3",children:z.map(t=>{const s=de(t.status),r=s.icon;return e.jsx(b.div,{className:`p-3 sm:p-3.5 rounded-xl bg-indigo-900/30 border border-indigo-700/40 hover:border-indigo-400/50 transition hover:shadow-lg ${s.rowAccent}`,whileHover:{y:-2},children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-start sm:items-center gap-3 min-w-0",children:[e.jsx("div",{className:"relative w-10 h-10 rounded-xl grid place-items-center bg-gradient-to-br from-violet-500 to-fuchsia-500 ring-2 ring-white/20 flex-shrink-0",children:e.jsx(B,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"inline-block rounded-lg px-2.5 py-1 bg-white/5 border border-white/10 backdrop-blur-sm shadow-sm max-w-full",children:e.jsx("span",{className:"text-slate-100 font-semibold text-sm leading-snug break-words",children:t.reward_value})}),e.jsx("p",{className:"mt-1 text-[11px] text-slate-400/80 font-mono truncate",children:t.requested_at?new Date(t.requested_at).toLocaleString():""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-xs font-semibold ${s.className} shadow`,children:[e.jsx(r,{className:"w-3.5 h-3.5"})," ",s.label]}),e.jsxs("button",{className:"inline-flex items-center gap-1.5 px-2 py-1 rounded-lg bg-white/5 border border-white/10 text-[11px] text-slate-200 hover:bg-white/10",onClick:async()=>{try{await navigator.clipboard.writeText(String(t.id)),x({title:"Copied",description:"Redemption ID copied"})}catch(l){x({title:"Copy failed",description:"Unable to copy ID",variant:"destructive"})}},title:"Copy redemption ID",children:[e.jsx(ke,{className:"w-3.5 h-3.5"})," ID"]})]})]})},t.id)})})}),e.jsx(he,{open:se,onOpenChange:t=>{t||(v(!1),V(null),N(""),k("upi"),D("confirm"),L(!1),Y("cash")),P(t)},children:e.jsx(pe,{className:`bg-slate-900/95 border-white/10 text-slate-100 rounded-xl sm:rounded-2xl p-0 overflow-hidden w-[min(94vw,600px)] sm:max-w-xl md:max-w-2xl max-h-[86svh] transition-transform duration-300 ${re&&ae?"translate-y-[-12svh]":""}`,children:c&&(()=>{const t=H==="voucher",s=t?"WhatsApp Number":f==="phone"?"Phone Number":"UPI ID",r=t?"Enter WhatsApp number (8-15 digits)":f==="phone"?"Enter phone number":"Enter UPI ID",l=t||f==="phone"?"tel":"text";return e.jsxs("div",{className:"p-4 sm:p-6 md:p-7",children:[e.jsxs(ge,{className:"flex flex-col items-center text-center",children:[e.jsxs(be,{className:"text-xl sm:text-2xl font-extrabold flex items-center justify-center gap-2",children:[e.jsx(Se,{className:"w-6 h-6 text-fuchsia-300"})," Redeem"]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(fe,{className:"text-slate-300 text-sm sm:text-base mt-1 max-w-[520px]",children:O==="confirm"?"Enter payout details to submit your request.":"Submitted. Pending admin approval."})})]}),e.jsx(ve,{className:"mt-6",children:O==="confirm"?e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"space-y-4 mb-5",children:[t?e.jsx("div",{className:"flex flex-col gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-400 mb-1 block",children:s}),e.jsx("input",{ref:E,value:M,onChange:a=>N(a.target.value),onFocus:()=>v(!0),onBlur:()=>v(!1),placeholder:r,inputMode:l,className:"w-full px-3 py-2 rounded-lg bg-slate-800/70 border border-slate-600 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50"}),e.jsx("p",{className:"mt-2 text-[11px] text-slate-400",children:"Voucher code WhatsApp par share kiya jayega."})]})}):e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-400 mb-1 block",children:"Payout Method"}),e.jsx("div",{className:"flex gap-2",children:["upi","phone"].map(a=>e.jsx("button",{type:"button",onClick:()=>k(a),className:`px-3 py-1.5 rounded-md text-xs font-semibold border transition ${f===a?"bg-indigo-600 text-white border-indigo-600":"bg-slate-800 text-slate-300 border-slate-600 hover:bg-slate-700"}`,children:a.toUpperCase()},a))})]}),e.jsxs("div",{className:"flex-[2]",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-400 mb-1 block",children:s}),e.jsx("input",{ref:E,value:M,onChange:a=>N(a.target.value),onFocus:()=>v(!0),onBlur:()=>v(!1),placeholder:r,inputMode:l,className:"w-full px-3 py-2 rounded-lg bg-slate-800/70 border border-slate-600 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50"})]})]}),(()=>{var i,o,m;const a=Number((m=(o=(i=c.coins_required)!=null?i:c.coin_cost)!=null?o:c.coins)!=null?m:0);return e.jsxs("div",{className:"text-xs text-slate-400 text-center",children:[e.jsx("span",{className:"text-white font-semibold",children:T(c)})," • ",e.jsxs("span",{className:"text-fuchsia-200 font-semibold",children:[a.toLocaleString()," coins"]})]})})()]}),(()=>{var o,m,d;const a=T(c),i=Number((d=(m=(o=c.coins_required)!=null?o:c.coin_cost)!=null?m:c.coins)!=null?d:0);return e.jsx(K,{onClick:me,disabled:W||$<i,className:"w-full bg-gradient-to-r from-indigo-600 to-fuchsia-600 hover:from-indigo-600 hover:to-fuchsia-600 text-base py-3 h-12",children:W?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting"]}):e.jsxs(e.Fragment,{children:["Redeem ",a]})})})()]}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"rounded-xl border border-emerald-400/30 bg-emerald-500/10 p-4 text-emerald-100 flex items-start gap-3",children:[e.jsx(X,{className:"w-5 h-5 text-emerald-300 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Redemption submitted"}),e.jsx("div",{className:"text-xs opacity-80",children:"Your request is pending admin approval. You will receive payout after review."})]})]}),e.jsx(we,{children:e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"relative h-0",children:[...Array(10)].map((a,i)=>e.jsx(b.span,{className:"absolute inline-block w-2 h-2 rounded-sm",style:{left:`${10+i*8}%`,top:-8,background:["#a78bfa","#f472b6","#60a5fa","#34d399","#f59e0b"][i%5]},initial:{y:-10,rotate:0,opacity:0},animate:{y:40+Math.random()*20,rotate:120+Math.random()*180,opacity:1},transition:{duration:.9,delay:i*.04,ease:"easeOut"}},i))})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(K,{onClick:()=>P(!1),variant:"brand",children:"Close"})})]})})]})})()})})]})}export{Le as default};
