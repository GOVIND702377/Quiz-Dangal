import{i as b,j as s,B as h}from"./index-75b73498.js";import{a as x}from"./react-8a702e3e.js";import"./supabase-4c1332f7.js";import"./router-f2cf3f51.js";import"./icons-e9c8901f.js";function S(){const{isSubscribed:u,subscribeToPush:m,unsubscribeFromPush:f,error:a}=b(),[i,g]=x.useState({permission:"unknown",swReady:!1,swScope:"",endpoint:"",hasVapid:!1});return x.useEffect(()=>{(async()=>{var r,o;try{const t=typeof Notification!="undefined"?Notification.permission:"unsupported";let c=!1,d="",l="";if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.ready;c=!!e,d=(e==null?void 0:e.scope)||"";const n=await e.pushManager.getSubscription();l=n!=null&&n.endpoint?String(n.endpoint):""}catch(e){console.debug("SW readiness/subscription check failed:",e)}const p=typeof window!="undefined"&&window.__QUIZ_DANGAL_ENV__?window.__QUIZ_DANGAL_ENV__:{},j=String(((o=(r=import.meta)==null?void 0:r.env)==null?void 0:o.VITE_VAPID_PUBLIC_KEY)||p.VITE_VAPID_PUBLIC_KEY||p.VAPID_PUBLIC_KEY||"").trim();g({permission:t,swReady:c,swScope:d,endpoint:l,hasVapid:j.length>0})}catch(t){console.debug("Notification diagnostics failed:",t)}})()},[]),s.jsxs("div",{className:"container mx-auto p-6 max-w-xl bg-white text-gray-900 rounded-2xl shadow-sm",children:[s.jsx("h1",{className:"text-xl font-semibold mb-2",children:"Notifications Diagnostics"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Yahan aap push setup ka quick status dekh sakte hain."}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Permission:"})," ",i.permission]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Service Worker Ready:"})," ",i.swReady?"Yes":"No"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"SW Scope:"})," ",s.jsx("span",{className:"break-all",children:i.swScope||"—"})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Subscribed:"})," ",u?"Yes":"No"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Endpoint:"})," ",s.jsx("span",{className:"break-all",children:i.endpoint||"—"})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"VAPID Public Key present:"})," ",i.hasVapid?"Yes":"No"]}),a&&s.jsxs("div",{className:"text-red-600",children:["Error: ",a]})]}),s.jsxs("div",{className:"mt-4 flex gap-2",children:[s.jsx(h,{onClick:m,children:"Subscribe"}),s.jsx(h,{variant:"outline",onClick:f,children:"Unsubscribe"})]}),s.jsx("div",{className:"text-xs text-gray-500 mt-4",children:"Dev tip: Agar local pe SW register nahi ho raha, URL me ?sw=1 add karke page ek baar open karein."})]})}export{S as default};
