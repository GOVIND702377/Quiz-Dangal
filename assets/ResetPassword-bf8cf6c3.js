import{a as R,r,s as l,j as e}from"./index-3d4d01e5.js";function S(){const d=R(),[x,n]=r.useState(!1),[i,f]=r.useState(""),[u,b]=r.useState(""),[h,g]=r.useState(!1),[w,o]=r.useState("");r.useEffect(()=>{const s=new URL(window.location.href),t=s.hash||"",m=s.search||"",p=new URLSearchParams(m),v=t.includes("type=recovery"),j=p.get("type")==="recovery",N=t.includes("access_token=")||p.has("code");(v||j||N)&&n(!0),(async()=>{try{const{data:a}=await l.auth.getSession();a!=null&&a.session&&window.location.pathname.includes("/reset-password")&&n(!0)}catch(a){}})();const{data:{subscription:c}}=l.auth.onAuthStateChange(a=>{a==="PASSWORD_RECOVERY"&&n(!0),a==="SIGNED_IN"&&n(!0)});return()=>c==null?void 0:c.unsubscribe()},[]);const y=async s=>{if(s.preventDefault(),i.length<6)return o("Password must be at least 6 characters.");if(i!==u)return o("Passwords do not match.");g(!0),o("");try{const{error:t}=await l.auth.updateUser({password:i});if(t)throw t;o("Password updated! Redirecting to sign in…");try{await l.auth.signOut()}catch(m){}d("/login?reset=1",{replace:!0})}catch(t){o((t==null?void 0:t.message)||"Failed to update password.")}finally{g(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/50 via-violet-900/40 to-fuchsia-900/40 backdrop-blur-xl border border-indigo-700/60 rounded-2xl p-8 max-w-md w-full shadow-xl text-slate-100",children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-violet-400 via-indigo-300 to-fuchsia-400 bg-clip-text text-transparent mb-2 text-center",children:"Reset Password"}),x?e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-200 mb-1",children:"New Password"}),e.jsx("input",{type:"password",className:"w-full border border-slate-300 bg-white text-black rounded-lg px-3 py-2",value:i,onChange:s=>f(s.target.value),placeholder:"Enter new password",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-200 mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"w-full border border-slate-300 bg-white text-black rounded-lg px-3 py-2",value:u,onChange:s=>b(s.target.value),placeholder:"Re-enter new password",required:!0})]}),w&&e.jsx("div",{className:"text-sm text-center text-slate-300",children:w}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-indigo-600 via-violet-600 to-fuchsia-600 hover:from-indigo-500 hover:to-fuchsia-700 text-white rounded-lg py-2.5 font-semibold",children:h?"Updating…":"Update Password"}),e.jsx("button",{type:"button",onClick:()=>d("/login"),className:"w-full bg-white text-black border border-slate-300 hover:bg-slate-50 rounded-lg shadow-md focus:ring-2 focus:ring-indigo-500/40 py-2.5 font-medium",children:"Back to Login"})]}):e.jsx("div",{className:"text-center text-slate-300",children:"The reset link is invalid or has expired, or you are already signed in. If you see this by mistake, open the link again or request a new reset from the Sign In screen."})]})})}export{S as default};
