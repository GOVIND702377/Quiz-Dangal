import{f as _,r,j as e,Y as j,Z as z,h as N,_ as k}from"./react-vendor-c284acb6.js";import{u as q,a as S,s as m,S as C}from"./index-e74e2d11.js";import{m as f}from"./motion-b88ded6b.js";import"./vendor-3e030596.js";import"./supabase-97550265.js";const E=[{title:"Opinion",slug:"opinion",icon:j,gradient:"from-[#f7971e] via-[#ffd200] to-[#f7971e]",accent:"shadow-[0_6px_18px_-5px_rgba(247,151,30,0.55)]",description:"Share what you think"},{title:"G.K Knowledge",slug:"gk",icon:z,gradient:"from-[#667db6] via-[#0082c8] to-[#667db6]",accent:"shadow-[0_6px_18px_-5px_rgba(0,130,200,0.55)]",description:"Boost your facts"},{title:"Sports",slug:"sports",icon:N,gradient:"from-[#43cea2] via-[#185a9d] to-[#43cea2]",accent:"shadow-[0_6px_18px_-5px_rgba(24,90,157,0.55)]",description:"Play & win glory"},{title:"Movies",slug:"movies",icon:k,gradient:"from-[#fe9a8b] via-[#fd868c] to-[#f9748f]",accent:"shadow-[0_6px_18px_-5px_rgba(249,116,143,0.55)]",description:"Cinema & stars"}],T=({tile:s,quizzes:c,onJoin:o,index:h})=>{const n=c.find(l=>(l.category||"").toLowerCase()===s.slug.toLowerCase());return e.jsxs(f.button,{type:"button",initial:{opacity:0,scale:.85},animate:{opacity:1,scale:1},transition:{duration:.35,delay:h*.06},whileTap:{scale:.95},onClick:()=>n&&o(n),className:`relative group aspect-square w-full rounded-3xl overflow-hidden focus:outline-none focus:ring-4 ring-white/30 text-left cursor-pointer shadow-lg ${s.accent}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s.gradient} opacity-90 group-hover:opacity-100 transition-opacity duration-300`}),e.jsx("div",{className:"absolute inset-0 mix-blend-overlay opacity-30 pointer-events-none",style:{backgroundImage:"radial-gradient(circle at 25% 25%, rgba(255,255,255,0.4) 0, rgba(255,255,255,0) 60%)"}}),e.jsx("div",{className:"absolute -top-1/2 -left-1/2 w-[180%] h-[180%] bg-[radial-gradient(circle_at_30%_30%,rgba(255,255,255,0.55),rgba(255,255,255,0)_60%)] opacity-0 group-hover:opacity-70 transition-opacity duration-500"}),e.jsxs("div",{className:"relative z-10 p-3 sm:p-4 flex flex-col h-full w-full justify-between",children:[e.jsxs("div",{className:"flex items-start justify-between w-full",children:[e.jsx(f.div,{whileHover:{rotate:5},className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl flex items-center justify-center bg-white/15 backdrop-blur-sm border border-white/30 shadow-inner",children:e.jsx(s.icon,{className:"w-6 h-6 text-white drop-shadow"})}),e.jsx(f.div,{initial:{opacity:0,y:-6},animate:{opacity:1,y:0},className:"px-2 py-1 rounded-full bg-white/20 border border-white/30 backdrop-blur-sm text-[10px] font-semibold tracking-wide uppercase text-white shadow",children:"Play"})]}),e.jsxs("div",{className:"space-y-1 select-none",children:[e.jsx("h3",{className:"text-white font-extrabold text-sm sm:text-base leading-tight drop-shadow-md",children:s.title}),e.jsx("p",{className:"text-[10px] sm:text-xs text-white/85 font-medium leading-snug line-clamp-2",children:s.description})]}),e.jsx("div",{className:"absolute inset-0 rounded-3xl ring-0 ring-white/0 group-hover:ring-4 transition-all duration-300"})]})]})},R=()=>{const{toast:s}=q(),c=_(),{user:o,userProfile:h,refreshUserProfile:n}=S(),[l,x]=r.useState([]),[y,b]=r.useState(!0),[d,g]=r.useState({open:!1,day:0,coins:0}),u=r.useRef(!1),p=r.useCallback(async()=>{try{const{data:t,error:a}=await m.from("quizzes").select("*").order("start_time",{ascending:!0});if(a)throw a;x(t||[])}catch(t){console.error(t),s({title:"Error",description:"Could not fetch quizzes.",variant:"destructive"}),x([])}finally{b(!1)}},[s]);r.useEffect(()=>{p();const t=setInterval(p,3e4);return()=>clearInterval(t)},[p]),r.useEffect(()=>{if(!o||u.current)return;const a=setTimeout(async()=>{u.current=!0;try{const{data:i,error:w}=await m.rpc("handle_daily_login",{user_uuid:o.id});if(w)return console.error(w);i&&i.is_new_login&&(await n(o),g({open:!0,day:i.streak_day,coins:i.coins_earned}))}finally{u.current=!1}},1200);return()=>clearTimeout(a)},[o,n]);const v=async t=>{try{const{data:a,error:i}=await m.rpc("join_quiz",{p_quiz_id:t.id});if(i)throw i;if(a&&a!=="Joined Successfully")throw new Error(a);s({title:"Joined!",description:"Redirecting you to the quiz."}),c(`/quiz/${t.id}`)}catch(a){s({title:"Error",description:a.message||"Could not join quiz.",variant:"destructive"})}};return e.jsxs("div",{className:"min-h-screen relative overflow-x-hidden",children:[e.jsx("div",{className:"home-bg"}),e.jsx("div",{className:"relative z-10 max-w-md mx-auto px-4 pb-8 pt-4 sm:pt-6",children:e.jsx("div",{className:"grid grid-cols-2 gap-3 mt-2",children:y?Array.from({length:4}).map((t,a)=>e.jsx("div",{className:"aspect-square w-full rounded-3xl bg-white/10 animate-pulse"},a)):E.map((t,a)=>e.jsx(T,{tile:t,quizzes:l,onJoin:v,index:a},t.slug))})}),e.jsx(C,{open:d.open,day:d.day,coins:d.coins,onClose:()=>g(t=>({...t,open:!1}))})]})};export{R as default};
