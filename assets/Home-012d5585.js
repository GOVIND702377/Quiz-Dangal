import{u as z,a as b,s as y,j as i,S as j}from"./index-b088f8ff.js";import{r as u}from"./react-63c462fe.js";import{S as q}from"./SEO-46cc4379.js";import{a as _}from"./router-10fed1f4.js";import{b as k,B as I,T as N,c as S}from"./icons-590232b1.js";import"./supabase-07ebd5d8.js";const C=[{title:"Opinion",slug:"opinion",icon:k},{title:"G.K Knowledge",slug:"gk",icon:I},{title:"Sports",slug:"sports",icon:N},{title:"Movies",slug:"movies",icon:S}],T=({tile:a,quizzes:m,index:f,navigateTo:h})=>{const c=Date.now();m.filter(s=>(s.category||"").toLowerCase()===a.slug.toLowerCase()).filter(s=>{const r=s.start_time?new Date(s.start_time).getTime():0,d=s.end_time?new Date(s.end_time).getTime():0,v=r&&d&&c>=r&&c<d,e=r&&c<r;return v||e}).sort((s,r)=>new Date(s.start_time||s.end_time||0)-new Date(r.start_time||r.end_time||0));const w=a.icon,g=["neon-orange","neon-purple","neon-teal","neon-pink"],p="PLAY",x=`${f*80}ms`;return i.jsx("button",{type:"button",onClick:()=>h(a.slug),className:`neon-card ${g[f%g.length]} group aspect-square w-full rounded-xl focus:outline-none transform-gpu transition-transform hover:scale-[1.02] hover:shadow-xl relative animate-fade-scale`,style:{borderRadius:"0.75rem","--fade-scale-delay":x},"aria-label":`${a.title} - Play`,children:i.jsx("div",{className:"neon-card-content select-none flex items-center justify-center",children:i.jsxs("div",{className:"w-full flex flex-col items-center justify-center gap-2",children:[i.jsx(w,{className:"w-8 h-8 text-white drop-shadow"}),i.jsx("h3",{className:"text-base font-extrabold leading-tight text-white text-shadow-sm text-center",children:a.title}),i.jsx("span",{className:"play-pill group-hover:shadow-lg group-hover:brightness-110",children:p})]})})})},A=()=>{const{toast:a}=z(),m=_(),{user:f}=b(),[h,c]=u.useState([]),[w,g]=u.useState(!0),[p,x]=u.useState({open:!1,day:0,coins:0}),[s,r]=u.useState(null),d=u.useCallback(async()=>{try{const{data:e,error:t}=await y.from("quizzes").select("id,title,category,start_time,end_time,status,prize_pool,prizes,prize_type").order("start_time",{ascending:!0});if(t)throw t;c(e||[])}catch(e){console.error(e),a({title:"Error",description:"Could not fetch quizzes.",variant:"destructive"}),c([])}finally{g(!1)}},[a]);u.useEffect(()=>{let e=!1,t=null,n=null,o=null;const l=async()=>{e||(await d(),!e&&(o=window.setInterval(d,6e4)))};return typeof window!="undefined"&&"requestIdleCallback"in window?t=window.requestIdleCallback(l,{timeout:1200}):n=window.setTimeout(l,120),()=>{e=!0,o&&clearInterval(o),n&&clearTimeout(n),t!==null&&typeof window!="undefined"&&"cancelIdleCallback"in window&&window.cancelIdleCallback(t)}},[d]);const v=async e=>{if(!(!e||s===e.id)){if(!f){a({title:"Login required",description:"Please sign in to join the quiz.",variant:"destructive"}),m("/login");return}r(e.id);try{const t=e.status==="upcoming"?"pre_join_quiz":"join_quiz",{data:n,error:o}=await y.rpc(t,{p_quiz_id:e.id});if(o)throw o;if(e.status==="upcoming")a({title:"Pre-joined!",description:"We will remind you 1 minute before start."});else{if(n&&n!=="Joined Successfully")throw new Error(n);a({title:"Joined!",description:"Redirecting you to the quiz."}),m(`/quiz/${e.id}`)}}catch(t){const n=String((t==null?void 0:t.message)||"").toLowerCase();let o=(t==null?void 0:t.message)||"Could not join quiz.",l="Error";n.includes("not authenticated")?(l="Login required",o="Please sign in to join the quiz."):n.includes("insufficient balance")?(l="Insufficient balance",o="You do not have enough coins to join this quiz."):n.includes("quiz not active")&&(l="Quiz not active",o="This quiz is not active right now."),a({title:l,description:o,variant:"destructive"})}finally{r(null)}}};return i.jsxs("div",{className:"h-full relative overflow-hidden",children:[i.jsx(q,{title:"Quiz Dangal – Play Quiz & Win Rewards | Opinion, GK, Sports, Movies",description:"Play daily opinion-based quizzes on Quiz Dangal. Win coins, climb leaderboards, and refer & earn with friends. India’s top play & win quiz app.",canonical:"https://quizdangal.com/",keywords:["Quiz Dangal","quizdangal","quiz app","play quiz and win","opinion quiz","daily quiz India","refer and earn quiz","win rewards","leaderboards","online quiz contest"],alternateLocales:["hi_IN","en_US"]}),i.jsx("div",{className:"relative z-10 h-full flex items-center justify-center px-4 mt-1 sm:mt-2 mb-6",children:i.jsxs("div",{className:"w-full max-w-[420px]",children:[i.jsxs("div",{className:"text-center mb-4 animate-fade-up",style:{"--fade-delay":"60ms"},children:[i.jsx("h1",{className:"text-xl font-extrabold tracking-tight bg-gradient-to-r from-indigo-200 via-fuchsia-200 to-pink-200 bg-clip-text text-transparent",children:"Brain games, real gains. Ready to shine?"}),i.jsx("p",{className:"text-[13px] text-slate-300/90 mt-1",children:"Compete, earn, repeat — where winners never chill out."}),i.jsx("div",{className:"mx-auto mt-2 h-[2px] w-24 rounded-full bg-gradient-to-r from-indigo-400/60 via-fuchsia-400/60 to-pink-400/60"})]}),i.jsx("div",{className:"grid grid-cols-2 gap-3",children:w?Array.from({length:4}).map((e,t)=>i.jsx("div",{className:"aspect-square w-full rounded-xl bg-slate-800/60 border border-slate-700/60 animate-pulse"},t)):C.map((e,t)=>i.jsx(T,{tile:e,quizzes:h,onJoin:v,index:t,joiningId:s,navigateTo:n=>m(`/category/${n}`)},e.slug))})]})}),i.jsx(j,{open:p.open,day:p.day,coins:p.coins,onClose:()=>x(e=>({...e,open:!1}))})]})};export{A as default};
