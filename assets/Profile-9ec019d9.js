import{c as g,b as V,r as l,e as W,s as d,j as e,L as J,d as E,f as K,g as Q,B as X,P as Z,h as ee,G as se}from"./index-d3eb7f4e.js";import{A as M}from"./award-16b1fbe9.js";import{C as A}from"./chevron-right-8c84ce96.js";import{I as te,F as ae}from"./info-fc94661d.js";import{M as re}from"./mail-ba79e1a6.js";import{S as le}from"./shield-94617d60.js";import{S as ie}from"./share-2-eebba3ec.js";const ne=g("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]),oe=g("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),de=g("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);function be(){var k,C;const{signOut:R}=V(),[U,f]=l.useState(!0),[n,_]=l.useState(null),[s,x]=l.useState(null),[b,p]=l.useState(!1),[v,$]=l.useState(!1),[B,j]=l.useState(!1),[T,w]=l.useState(!1),c=l.useRef(null),{isSubscribed:m,subscribeToPush:z,error:N}=W(),o=l.useCallback(async()=>{f(!0);try{const{data:{session:t}}=await d.auth.getSession(),a=(t==null?void 0:t.user)||null;if(_(a),a){const{data:i,error:r}=await d.from("profiles").select("*").eq("id",a.id).single();if(r)throw r;x(i)}else x(null)}catch(t){x(null)}finally{f(!1)}},[]);l.useEffect(()=>{o()},[o]);const I=async()=>{await R()},O=()=>{var t;return(t=c.current)==null?void 0:t.click()},q=async t=>{var i;const a=(i=t.target.files)==null?void 0:i[0];if(!(!a||!n)){p(!0);try{const r=`${n.id}/${Date.now()}-${a.name}`,{error:S}=await d.storage.from("avatars").upload(r,a,{upsert:!0});if(S)throw S;const{data:h}=d.storage.from("avatars").getPublicUrl(r),L=h==null?void 0:h.publicUrl;if(!L)throw new Error("Could not get public URL");const{error:P}=await d.from("profiles").update({avatar_url:L}).eq("id",n.id);if(P)throw P;await o(),alert("Avatar updated")}catch(r){alert(`Avatar change failed: ${(r==null?void 0:r.message)||"Try again later"}`)}finally{p(!1),c.current&&(c.current.value="")}}},D=t=>{const a=Number(t||0);return a>=20?"ring-[#8b5cf6]":a>=10?"ring-[#f59e0b]":a>=5?"ring-[#9ca3af]":"ring-[#cd7f32]"},F=t=>{const a=Number(t||0);return a>=20?"Legend":a>=10?"Pro":a>=5?"Explorer":"Rookie"},y=t=>{const a=Number(t||0),i=100;return Math.max(0,Math.min(100,Math.round(a%i/i*100)))},G=["Rookie","Explorer","Challenger","Pro","Legend","Streak 7","Streak 30","Top 10","Winner","Referral Pro"],u=Array.isArray(s==null?void 0:s.badges)?s.badges:[],H=G.filter(t=>!u.includes(t));if(U)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(J,{className:"w-8 h-8 animate-spin text-indigo-300"})});if(!n)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-800/40 text-indigo-300 flex items-center justify-center mb-3 border border-indigo-700/60",children:e.jsx(oe,{className:"w-6 h-6"})}),e.jsxs("p",{className:"text-lg text-slate-200",children:["You are not logged in or session expired.",e.jsx("br",{}),"Please ",e.jsx(E,{to:"/login",className:"text-indigo-300 underline",children:"login"})," to view your profile."]})]});const Y=[{label:"About Us",href:"/about-us",icon:te},{label:"Contact Us",href:"/contact-us",icon:re},{label:"Terms & Conditions",href:"/terms-conditions",icon:ae},{label:"Privacy Policy",href:"/privacy-policy",icon:le},{label:"Language",onClick:()=>w(!0),icon:se},{label:"Refer & Earn",href:"/refer",icon:ie}];return e.jsx("div",{className:"relative min-h-[100svh]",children:e.jsxs("div",{className:"container mx-auto px-2 md:px-3 py-2 max-w-3xl space-y-2",children:[e.jsxs("div",{className:"group relative overflow-hidden rounded-3xl p-4 bg-gradient-to-br from-indigo-900/50 via-violet-900/40 to-fuchsia-900/40 backdrop-blur-xl shadow-xl border border-indigo-700/60",children:[e.jsx("div",{"aria-hidden":!0,className:"pointer-events-none absolute -top-20 -right-20 h-56 w-56 rounded-full bg-gradient-to-tr from-indigo-500/20 via-fuchsia-400/15 to-transparent blur-3xl"}),e.jsx("div",{"aria-hidden":!0,className:"pointer-events-none absolute -bottom-24 -left-24 h-56 w-56 rounded-full bg-gradient-to-tr from-purple-500/15 via-pink-500/10 to-transparent blur-3xl"}),e.jsxs("div",{className:"flex flex-col gap-3 relative",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center -ml-2",children:[e.jsxs("div",{className:"relative w-[5.5rem] h-[5.5rem]",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-tr from-indigo-400/20 via-fuchsia-400/20 to-transparent blur-[3px] animate-spin",style:{animationDuration:"9s"}}),e.jsx("div",{className:`relative w-[5.5rem] h-[5.5rem] rounded-full overflow-hidden flex items-center justify-center text-slate-100 font-bold ring-2 ring-offset-2 ring-offset-slate-900 ${D(s==null?void 0:s.level)} bg-gradient-to-br from-slate-800 to-slate-700 shadow-md`,children:s!=null&&s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:((s==null?void 0:s.full_name)||(n==null?void 0:n.email)||"U").charAt(0).toUpperCase()})})}),e.jsx("button",{onClick:O,disabled:b,className:"absolute -bottom-2 -right-2 p-2 rounded-xl bg-slate-900/80 border border-slate-700/60 shadow-sm text-slate-200 hover:bg-slate-800 transition disabled:opacity-60",title:b?"Uploadingâ€¦":"Change avatar",children:e.jsx(K,{className:"w-4 h-4"})}),e.jsx("input",{ref:c,type:"file",accept:"image/*",className:"hidden",onChange:q})]}),e.jsxs("div",{className:"mt-1.5 text-center",children:[e.jsx("div",{className:"text-[11px] text-slate-400",children:"Email"}),e.jsx("div",{className:"text-sm font-medium text-slate-100 whitespace-nowrap overflow-x-auto",children:(s==null?void 0:s.email)||n.email})]})]}),e.jsxs("div",{className:"min-w-0 -mt-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsx(Q,{className:"w-4 h-4 text-indigo-300"}),e.jsx("span",{children:"Welcome back"})]}),e.jsx("div",{className:"text-sm font-semibold text-white truncate",children:s!=null&&s.username?`@${s.username}`:"Username not set"}),e.jsx("div",{className:"mt-1.5 flex flex-wrap gap-2 text-xs",children:e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-amber-900/20 text-amber-200 border border-amber-500/20",children:[e.jsx(M,{className:"w-3.5 h-3.5"}),e.jsxs("span",{className:"font-medium",children:[Number((k=s==null?void 0:s.wallet_balance)!=null?k:0).toLocaleString()," Coins"]})]})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"mt-1.5 inline-flex items-center gap-2",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full text-[11px] bg-indigo-900/30 text-indigo-200 border border-indigo-500/30",children:["Level ",(C=s==null?void 0:s.level)!=null?C:"â€”"]}),e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] bg-slate-800/60 text-slate-200 border border-slate-700/60",children:F(s==null?void 0:s.level)})]}),e.jsxs("div",{className:"mt-1.5 relative h-2.5 bg-slate-800/70 rounded-full overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-white/10"}),e.jsx("div",{className:"relative h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-fuchsia-500 shadow-[0_0_12px_rgba(99,102,241,0.35)]",style:{width:`${y(s==null?void 0:s.total_coins)}%`}}),e.jsxs("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-[10px] text-slate-300",children:[y(s==null?void 0:s.total_coins),"%"]})]}),e.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"to next level"}),e.jsx("button",{onClick:()=>$(t=>!t),className:"mt-1.5 text-xs text-indigo-300 hover:text-indigo-200 underline",children:v?"Hide badges":"View badges"})]}),e.jsx("div",{className:"pt-2 mt-1 w-full border-t border-gray-100",children:e.jsx("button",{onClick:()=>j(!0),className:"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow hover:shadow-md text-sm transition",children:"Edit Profile"})})]})]}),v&&e.jsxs("div",{className:"rounded-3xl p-4 bg-gradient-to-br from-indigo-900/50 via-violet-900/40 to-fuchsia-900/40 backdrop-blur-xl shadow-xl border border-indigo-700/60",children:[e.jsxs("div",{className:"text-sm font-semibold text-white mb-2 flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-amber-300"}),e.jsx("span",{children:"Your Badges"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:u.length>0?u.map((t,a)=>e.jsxs("span",{className:"px-2.5 py-1.5 text-[11px] rounded-full bg-indigo-800/40 border border-indigo-500/30 text-indigo-100",children:["âœ¨ ",t]},`u-${a}`)):e.jsx("span",{className:"text-xs text-slate-400",children:"No badges unlocked yet"})}),e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Locked"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:H.map((t,a)=>e.jsxs("span",{className:"px-2.5 py-1.5 text-[11px] rounded-full bg-slate-800/60 border border-slate-700/60 text-slate-300",children:["ðŸ”’ ",t]},`l-${a}`))})]}),e.jsxs("div",{className:"rounded-3xl p-4 bg-gradient-to-br from-indigo-900/50 via-violet-900/40 to-fuchsia-900/40 backdrop-blur-xl shadow-xl border border-indigo-700/60 text-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-9 h-9 rounded-xl bg-gradient-to-br from-cyan-700/50 to-emerald-700/50 text-emerald-200 flex items-center justify-center shadow-sm border border-emerald-500/30",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Push Notifications"}),e.jsx("p",{className:"text-xs text-slate-400",children:m?"You are subscribed to notifications.":"Enable to get alerts for new quizzes."})]})]}),e.jsx(X,{onClick:z,disabled:m,size:"sm",children:m?"Subscribed":"Enable"})]}),N&&e.jsxs("p",{className:"text-xs text-rose-300 mt-2",children:["Error: ",N]})]}),e.jsx("div",{className:"rounded-3xl p-3 bg-gradient-to-br from-indigo-900/50 via-violet-900/40 to-fuchsia-900/40 backdrop-blur-xl shadow-xl border border-indigo-700/60",children:e.jsx("div",{className:"flex flex-col gap-3",children:Y.map((t,a)=>{const i=["from-indigo-700/60 to-fuchsia-700/60","from-amber-700/50 to-orange-700/50","from-cyan-700/50 to-emerald-700/50","from-fuchsia-700/60 to-pink-700/60","from-violet-700/60 to-indigo-700/60","from-amber-700/60 to-yellow-700/60"][a%6],r=e.jsxs("div",{className:"group w-full flex items-center justify-between px-3.5 py-2.5 rounded-2xl border border-indigo-700/60 bg-indigo-900/40 hover:bg-indigo-900/60 transition shadow-sm hover:shadow-lg text-sm text-slate-100 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-9 h-9 rounded-xl bg-gradient-to-br ${i} text-indigo-100 flex items-center justify-center shadow-sm border border-indigo-500/30 group-hover:scale-[1.03] transition`,children:e.jsx(t.icon,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-semibold tracking-wide",children:t.label})]}),e.jsx(A,{className:"w-4 h-4 text-slate-500 group-hover:text-slate-300 transition"})]});return t.href?e.jsx(E,{to:t.href,tabIndex:0,className:"focus:outline-none focus:ring-2 focus:ring-indigo-500/40 rounded-2xl",children:r},a):e.jsx("button",{onClick:t.onClick,className:"text-left w-full focus:outline-none focus:ring-2 focus:ring-indigo-500/40 rounded-2xl",children:r},a)})})}),e.jsx("div",{className:"rounded-3xl p-3 bg-gradient-to-br from-indigo-900/50 via-violet-900/40 to-fuchsia-900/40 backdrop-blur-xl shadow-xl border border-indigo-700/60",children:e.jsx("button",{onClick:I,className:"w-full text-left focus:outline-none focus:ring-2 focus:ring-red-500/30 rounded-2xl",children:e.jsxs("div",{className:"group w-full flex items-center justify-between px-3.5 py-2.5 rounded-2xl border border-rose-700/40 bg-rose-900/10 hover:bg-rose-900/20 transition shadow-sm hover:shadow-md text-sm text-rose-300 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-9 h-9 rounded-xl bg-rose-900/30 text-rose-300 flex items-center justify-center shadow-sm border border-rose-700/40 group-hover:scale-[1.03] transition",children:e.jsx(de,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-semibold tracking-wide",children:"Logout"})]}),e.jsx(A,{className:"w-4 h-4 text-rose-400/70 group-hover:text-rose-300 transition"})]})})}),e.jsx(Z,{isOpen:B,onClose:()=>{j(!1),o()},isFirstTime:!1}),e.jsx(ee,{isOpen:T,onComplete:()=>{w(!1),o()}})]})})}export{be as default};
