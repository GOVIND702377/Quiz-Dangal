import{_ as ft}from"./supabase-4c1332f7.js";import{u as ht,a as xt,s as H,g as de,j as t,B as J,n as ut,c as pt}from"./index-d8c98b97.js";import{r as k}from"./react-8a702e3e.js";import{g as gt}from"./avatar-19ed3b59.js";import{c as bt,a as wt}from"./router-f2cf3f51.js";import{d as vt,T as Fe,S as jt,$ as yt,f as Nt}from"./icons-52d1b41a.js";import{m as _t}from"./motion-f69b6c08.js";const Ut=()=>{const{id:L}=bt(),K=wt(),{toast:O}=ht(),{user:j,userProfile:w}=xt(),[i,Qe]=k.useState(null),[z,Z]=k.useState([]),[f,Ge]=k.useState(null),[me,ee]=k.useState(!0),[_e,te]=k.useState(""),[Se,Y]=k.useState(null),[Ve,Xe]=k.useState(!1),[ke,fe]=k.useState(null),Je={hidden:{opacity:0,y:10},show:{opacity:1,y:0,transition:{duration:.2}}};k.useEffect(()=>{he()},[L]);const he=async()=>{try{te("");const{data:s}=await H.from("quizzes").select("*").eq("id",L).single();if(Qe(s||null),(w==null?void 0:w.role)!=="admin")try{const{data:n}=await H.from("quiz_participants").select("status").eq("quiz_id",L).eq("user_id",j==null?void 0:j.id).maybeSingle();if(!!!n){te("You did not participate in this quiz. Results are visible only to participants."),ee(!1);return}}catch(n){}const{data:a,error:l}=await H.from("quiz_results").select("leaderboard").eq("quiz_id",L).maybeSingle();if(l)throw l;const e=Array.isArray(a==null?void 0:a.leaderboard)?a.leaderboard:[];if(!a||e.length===0){if(Z([]),s!=null&&s.end_time){const h=new Date(s.end_time).getTime()-Date.now();if(Y(h>0?h:0),h<=0)try{await H.rpc("compute_results_if_due",{p_quiz_id:L}),await new Promise(v=>setTimeout(v,500));const{data:m}=await H.from("quiz_results").select("leaderboard").eq("quiz_id",L).maybeSingle(),b=Array.isArray(m==null?void 0:m.leaderboard)?m.leaderboard:[];if(b.length>0){const v=b.map((u,y)=>{var N;return{id:`${L}-${u.user_id}`,user_id:u.user_id,score:Number(u.score)||0,rank:Number(u.rank)||y+1,profiles:{username:(N=u.display_name)!=null&&N.startsWith("@")?u.display_name.slice(1):void 0,full_name:u.display_name,avatar_url:void 0}}}).sort((u,y)=>y.score-u.score);Z(v),ee(!1);return}}catch(m){}}else Y(null);return}const g=e.map((n,h)=>{var m;return{id:`${L}-${n.user_id}`,user_id:n.user_id,score:Number(n.score)||0,rank:Number(n.rank)||h+1,profiles:{username:(m=n.display_name)!=null&&m.startsWith("@")?n.display_name.slice(1):void 0,full_name:n.display_name,avatar_url:void 0}}}).sort((n,h)=>h.score-n.score);Z(g);try{const n=g.slice(0,10).map(h=>h.user_id);if(n.length){const{data:h,error:m}=await H.rpc("profiles_public_by_ids",{p_ids:n});if(m&&console.warn("Public profile fetch failed:",m),Array.isArray(h)&&h.length){const b=new Map(h.map(u=>[u.id,u])),v=await gt(h.map(u=>u.avatar_url).filter(Boolean));Z(u=>u.map(y=>{const N=b.get(y.user_id);if(!N)return y;const P=N.avatar_url&&v.get(N.avatar_url)||"";return{...y,profiles:{username:N.username,full_name:N.full_name,avatar_url:P}}}))}}}catch(n){}const d=g.find(n=>n.user_id===(j==null?void 0:j.id));d&&Ge(d)}catch(s){console.error("Error fetching results:",s),te((s==null?void 0:s.message)||"Failed to load results.")}finally{ee(!1)}},ze=()=>{ee(!0),te(""),he()};k.useEffect(()=>{let s=!1;return(async()=>{try{if(z.length===0){fe(null);return}const l=await xe();s||fe(l)}catch(l){s||fe(null)}})(),()=>{s=!0}},[z.length,L,f==null?void 0:f.rank,f==null?void 0:f.score]);const se=(i==null?void 0:i.prize_type)||"money",Te=f!=null&&f.rank&&Array.isArray(i==null?void 0:i.prizes)&&i.prizes[f.rank-1]?i.prizes[f.rank-1]:0,ae=de(se,Te,{fallback:0}),xe=async()=>{try{const l=document.createElement("canvas");l.width=1080,l.height=1920;const e=l.getContext("2d");e.textBaseline="top";const g="Inter, system-ui, -apple-system, Segoe UI, Roboto",d=(r,o)=>{e.font=`${r} ${o}px ${g}`},n=r=>e.measureText(r).width,h=(r,o,c,x,p)=>{let S=x;for(d(c,S);S>p&&n(r)>o;)S-=2,d(c,S);return S},m=(r,o,c,x)=>{d(c,x);const p=String(r).split(/\s+/),S=[];let R="";for(const D of p){const ce=R?R+" "+D:D;n(ce)<=o?R=ce:(R&&S.push(R),R=D)}return R&&S.push(R),S},b=(r,o,c,x,p,S,R,D,ce)=>{let $=S,X=m(r,x,p,$);for(;(X.length>D||X.some(B=>n(B)>x))&&$>R;)$-=1,X=m(r,x,p,$);d(p,$),e.fillStyle=ce;const He=Math.round($*1.25),Oe=Math.min(D,X.length);for(let B=0;B<Oe;B++){const Ye=X[B],mt=n(Ye);e.fillText(Ye,o-mt/2,c+B*He)}return{height:Oe*He,size:$}},v=(r,o)=>{let c=String(r);for(;c&&n(c)>o;)c=c.slice(0,-1);return c.length<String(r).length?c.slice(0,Math.max(0,c.length-1))+"â€¦":c},u=r=>new Promise((o,c)=>{const x=new Image;x.crossOrigin="anonymous",x.onload=()=>o(x),x.onerror=c,x.src=r}),y=(r,o,c,x,p)=>{e.beginPath(),e.moveTo(r+p,o),e.lineTo(r+c-p,o),e.quadraticCurveTo(r+c,o,r+c,o+p),e.lineTo(r+c,o+x-p),e.quadraticCurveTo(r+c,o+x,r+c-p,o+x),e.lineTo(r+p,o+x),e.quadraticCurveTo(r,o+x,r,o+x-p),e.lineTo(r,o+p),e.quadraticCurveTo(r,o,r+p,o),e.closePath()},N=e.createLinearGradient(0,0,1080,1920);N.addColorStop(0,"#150a36"),N.addColorStop(1,"#0f0926"),e.fillStyle=N,e.fillRect(0,0,1080,1920);const P=64,T=1080/2;let _=P+12;const C=140,U=_+C;e.save(),e.beginPath(),e.arc(T,U,C,0,Math.PI*2),e.closePath();const ue=e.createLinearGradient(T-C,U-C,T+C,U+C);ue.addColorStop(0,"#1cc5ff"),ue.addColorStop(1,"#ef47ff"),e.fillStyle=ue,e.fill();try{const o=({}.VITE_POSTER_LOGO_URL||"").trim()||"/android-chrome-192x192.png";let c;try{c=await u(o)}catch(S){c=await u("/android-chrome-192x192.png")}const x=16,p=C*2-x;e.save(),e.beginPath(),e.arc(T,U,C-x/2,0,Math.PI*2),e.clip(),e.drawImage(c,Math.round(T-p/2),Math.round(U-p/2),Math.round(p),Math.round(p)),e.restore(),e.lineWidth=2,e.strokeStyle="rgba(255,255,255,0.7)",e.beginPath(),e.arc(T,U,C-x/2,0,Math.PI*2),e.stroke()}catch(r){}e.restore(),_=U+C+18;const tt=`ðŸ… ${((w==null?void 0:w.full_name)||(w==null?void 0:w.username)||"Your").toString().toUpperCase()}â€™S LEGENDARY RUN ðŸ…`,st=b(tt,T,_,1080-P*2,"900",56,34,2,"#ffd54a");_+=st.height+16;const at=b("âœ¨ Brains = Fame âœ¨",T,_,1080-P*2,"700",36,22,1,"rgba(255,255,255,0.9)");_+=at.height+28;const I=P,M=1080-P*2,pe=I+56,Ce=48,rt=40,Me=f!=null&&f.rank?`#${f.rank} Rank!`:"Results Live!",re=de(se,Te,{fallback:0}),Re=`ðŸ‘‘ Prize: ${re.showIconSeparately&&re.icon?`${re.icon} `:""}${re.formatted}`,F=typeof(f==null?void 0:f.score)=="number"?`â˜‘ï¸ Score: ${f.score}`:"",ge=h(Me,M-100,"900",112,80),be=h(Re,M-100,"900",48,32),we=F?h(F,M-100,"900",44,28):0,nt=Math.round(ge*1)+24+Math.round(be*1.15)+12+(F?Math.round(we*1.15)+12:0),Le=Ce+nt+rt,Q=_,ve=e.createLinearGradient(I,Q,I+M,Q);ve.addColorStop(0,"rgba(34,211,238,0.9)"),ve.addColorStop(1,"rgba(236,72,153,0.9)"),e.save(),y(I,Q,M,Le,36),e.fillStyle="rgba(15,23,42,0.72)",e.fill(),e.lineWidth=4,e.strokeStyle=ve,e.stroke(),e.restore();let q=Q+Ce;d("900",ge),e.fillStyle="#ffffff",e.fillText(Me,pe,q),q+=Math.round(ge*1)+24,d("900",be),e.fillStyle="#ffd54a",e.fillText(Re,pe,q),q+=Math.round(be*1.15)+12,F&&(d("900",we),e.fillStyle="rgba(168,255,230,0.95)",e.fillText(F,pe,q),q+=Math.round(we*1.15)+12),_=Q+Le+28;const Pe=230,Ae=Math.max(120,1920-P-Pe-_),je="âš¡ My Result is Live!",ye=h(je,M-120,"900",48,26),lt="â€œThink you can beat me? Join Quiz Dangal & prove it ðŸ‘€â€",ne=26,Ie=Math.round(ne*1.25);d("700",ne);const Ue=m(lt,M-120,"700",ne).slice(0,2),it=Ue.length*Ie;let le=28+Math.round(ye)+12+it+28;le>Ae&&(le=Ae);const ie=_;y(I,ie,M,le,28),e.fillStyle="rgba(8,11,30,0.9)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(56,189,248,0.5)",e.stroke(),d("900",ye),e.fillStyle="#facc15";const ot=n(je);e.fillText(je,T-ot/2,ie+28),d("700",ne),e.fillStyle="rgba(226,232,240,0.92)";let We=ie+28+Math.round(ye)+12;for(const r of Ue){const o=n(r);e.fillText(r,T-o/2,We),We+=Ie}_=ie+le+24;const A=_,G=Math.max(Pe,Math.min(280,1920-P-A));y(I,A,M,G,24),e.fillStyle="rgba(12,10,36,0.9)",e.fill(),e.lineWidth=2,e.strokeStyle="rgba(79,70,229,0.45)",e.stroke();const ct=(()=>w!=null&&w.referral_code?w.referral_code:j!=null&&j.id?j.id.replace(/-/g,"").slice(0,8).toUpperCase():"")(),oe=ut(ct),dt=`${({}.VITE_PUBLIC_SITE_URL||"https://www.quizdangal.com").replace(/\/$/,"")}/?ref=${encodeURIComponent(oe)}`;oe&&pt(oe);const V=Math.min(220,G-72),$e=V+32,qe=V+40,Ne=I+M-$e-36,Ee=A+Math.max(24,Math.round((G-qe)/2));y(Ne,Ee,$e,qe,18),e.fillStyle="#ffffff",e.fill();try{const{default:r}=await ft(()=>import("./browser-864b0b18.js").then(c=>c.b),[]),o=document.createElement("canvas");await r.toCanvas(o,dt,{width:V,margin:1,color:{dark:"#000000",light:"#ffffff"}}),e.drawImage(o,Ne+16,Ee+16,V,V)}catch(r){}const W=I+36,E=Ne-24-W;e.fillStyle="rgba(255,255,255,0.96)",d("900",48),e.fillText(v("ðŸ§  Play & Win",E),W,A+36),e.fillStyle="rgba(203,213,225,0.98)",d("800",36),e.fillText(v("ðŸŒ www.quizdangal.com",E),W,A+36+54),d("900",44),e.fillStyle="rgba(255,255,255,0.96)";const De="ðŸ”— Referral: ",Be=n(De);return e.fillText(v(De,E),W,A+36+54+62),e.fillStyle="rgba(0,255,198,1)",e.fillText(v(oe,Math.max(0,E-Be-8)),W+Be,A+36+54+62),d("700",26),e.fillStyle="rgba(226,232,240,0.92)",e.fillText(v("Your turn to flex your brain ðŸ’¯",E),W,A+G-80),d("700",24),e.fillStyle="rgba(203,213,225,0.92)",e.fillText(v("#QuizDangal  #ChallengeAccepted  #PlayToWin",E),W,A+G-44),await new Promise(r=>l.toBlob(r,"image/jpeg",.92))}catch(s){try{const a=document.createElement("canvas");a.width=8,a.height=8;const l=a.getContext("2d"),e=l.createLinearGradient(0,0,8,8);return e.addColorStop(0,"#130531"),e.addColorStop(1,"#1e0b4b"),l.fillStyle=e,l.fillRect(0,0,8,8),await new Promise(d=>a.toBlob(d,"image/jpeg",.9))}catch(a){return null}}};k.useEffect(()=>{if(!(i!=null&&i.end_time)||z.length>0){Y(null);return}const s=new Date(i.end_time).getTime(),a=()=>{const e=s-Date.now();e>0?Y(e):(Y(0),Ve||(Xe(!0),he()))};a();const l=setInterval(a,1e3);return()=>clearInterval(l)},[i==null?void 0:i.end_time,z.length]);const Ke=s=>{const a=Math.max(0,Math.floor((s!=null?s:0)/1e3)),l=Math.floor(a/86400),e=Math.floor(a%86400/3600),g=Math.floor(a%3600/60),d=a%60;return{days:l,hours:e,minutes:g,seconds:d}},Ze=async()=>{try{let s=ke;if(s||(s=await xe()),s&&navigator.canShare&&window.File){const a=new File([s],"quiz-dangal-result.jpg",{type:"image/jpeg"});if(navigator.canShare({files:[a]})){await navigator.share({files:[a],title:"Quiz Dangal Result"}),O({title:"Shared!",description:"Poster shared from your device."});return}}if(s){const a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download="quiz-dangal-result.jpg",l.rel="noopener",document.body.appendChild(l),l.click(),document.body.removeChild(l),setTimeout(()=>URL.revokeObjectURL(a),1500),O({title:"Poster saved",description:"Share the image from your gallery."});return}O({title:"Share unavailable",description:"Try again after poster is ready."})}catch(s){O({title:"Share failed",description:(s==null?void 0:s.message)||"Try again",variant:"destructive"})}},et=async()=>{try{let s=ke;if(s||(s=await xe()),s&&navigator.canShare&&window.File){const m=new File([s],"quiz-dangal-result.jpg",{type:"image/jpeg"});if(navigator.canShare({files:[m]})){await navigator.share({files:[m],title:"Quiz Dangal Result"});return}}if(s)try{const m=URL.createObjectURL(s),b=document.createElement("a");b.href=m,b.download="quiz-dangal-result.jpg",b.rel="noopener",document.body.appendChild(b),b.click(),document.body.removeChild(b),setTimeout(()=>URL.revokeObjectURL(m),1500)}catch(m){}const a=navigator.userAgent||"",l=/Android/i.test(a),e=/iPhone|iPad|iPod/i.test(a),g="whatsapp://send",d="intent://send#Intent;scheme=whatsapp;package=com.whatsapp;end",n="https://wa.me/",h=m=>!!window.open(m,"_blank");if(l){if(h(g))return;window.location.href=d,setTimeout(()=>{document.hidden||(window.location.href=n)},700);return}if(e){window.location.href=g,setTimeout(()=>{document.hidden||(window.location.href=n)},700);return}h(n)}catch(s){O({title:"WhatsApp share failed",description:(s==null?void 0:s.message)||"Try again",variant:"destructive"})}};return me?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-accent-b"})}):!me&&_e?t.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",children:t.jsxs("div",{className:"qd-card rounded-2xl p-6 shadow-lg text-center max-w-md w-full text-slate-100",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2 text-white",children:"Couldn't load results"}),t.jsx("p",{className:"text-slate-300 mb-4",children:_e}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(J,{variant:"brand",onClick:ze,children:"Retry"}),t.jsx(J,{variant:"white",onClick:()=>K("/my-quizzes"),children:"Back"})]})]})}):!me&&z.length===0?t.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",children:t.jsxs("div",{className:"qd-card rounded-2xl p-6 shadow-lg text-center max-w-md w-full text-slate-100",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2 text-white",children:"Results not published yet"}),i!=null&&i.end_time?t.jsx("div",{className:"mb-4",children:Se>0?t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-300 mb-3",children:"Quiz ends in"}),(()=>{const{days:s,hours:a,minutes:l,seconds:e}=Ke(Se),g=(d,n)=>t.jsxs("div",{className:"px-3 py-2 rounded-md bg-slate-800/70 border border-slate-700 min-w-[64px]",children:[t.jsx("div",{className:"text-xl font-bold text-white tabular-nums",children:d.toString().padStart(2,"0")}),t.jsx("div",{className:"text-xs text-slate-400",children:n})]});return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s>0&&g(s,"Days"),g(a,"Hours"),g(l,"Minutes"),g(e,"Seconds")]})})(),t.jsxs("p",{className:"text-xs text-slate-400 mt-3",children:["End time: ",new Date(i.end_time).toLocaleString()]})]}):t.jsx("p",{className:"text-slate-300 mb-4",children:"Finalizing resultsâ€¦ please stay on this page."})}):t.jsx("p",{className:"text-slate-300 mb-4",children:"Please check back after the quiz end time."}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(J,{variant:"brand",onClick:ze,children:"Refresh"}),t.jsx(J,{variant:"white",onClick:()=>K("/my-quizzes"),children:"Back to My Quizzes"}),t.jsx(J,{variant:"white",onClick:()=>K("/"),children:"Go Home"})]})]})}):t.jsxs("div",{className:"min-h-screen p-4 pb-24 relative overflow-hidden",style:{paddingBottom:"calc(env(safe-area-inset-bottom, 0px) + 96px)"},children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[t.jsx("div",{className:"absolute -top-32 -right-16 w-80 h-80 rounded-full blur-3xl opacity-30 bg-gradient-to-br from-fuchsia-600 to-indigo-600"}),t.jsx("div",{className:"absolute -bottom-24 -left-16 w-96 h-96 rounded-full blur-3xl opacity-20 bg-gradient-to-br from-emerald-500 to-cyan-500"})]}),t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-4 rounded-2xl border border-slate-800 bg-slate-900/60 backdrop-blur p-4 sm:p-5 relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 pointer-events-none","aria-hidden":!0,children:t.jsx("div",{className:"absolute -inset-1 bg-[conic-gradient(var(--tw-gradient-stops))] from-fuchsia-500/10 via-indigo-500/5 to-cyan-500/10 blur-2xl"})}),t.jsxs("div",{className:"flex items-center justify-between gap-3 relative",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-slate-300 text-xs",children:[t.jsx(vt,{className:"w-3.5 h-3.5"}),t.jsxs("span",{children:[(z==null?void 0:z.length)||0," participants"]})]}),t.jsxs("h1",{className:"text-xl sm:text-2xl font-extrabold text-white tracking-tight flex items-center gap-2",children:[t.jsx(Fe,{className:"w-5 h-5 text-amber-300"})," Results"]}),t.jsx("p",{className:"text-xs text-slate-400 truncate max-w-[90vw]",children:i==null?void 0:i.title})]}),(f==null?void 0:f.rank)&&t.jsxs("div",{className:"shrink-0 text-center",children:[t.jsxs("div",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-lg bg-indigo-500/15 text-indigo-200 border border-indigo-600/30 text-xs font-semibold",children:[t.jsx(jt,{className:"w-3.5 h-3.5"})," You ranked"]}),t.jsxs("div",{className:"mt-1 text-2xl font-extrabold text-white",children:["#",f.rank]})]})]})]}),f&&(w==null?void 0:w.role)!=="admin"&&t.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-900/60 p-3 mb-4 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-indigo-500 via-violet-500 to-fuchsia-600 text-white font-bold flex items-center justify-center ring-1 ring-indigo-300/40",children:["#",f.rank]}),t.jsxs("div",{className:"text-xs text-slate-300",children:[t.jsx("div",{className:"text-white font-semibold",children:"Your Result"}),t.jsxs("div",{children:["Out of ",z.length," participants"]})]})]}),t.jsxs("div",{className:"flex items-center gap-3 text-center",children:[t.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-semibold bg-indigo-500/15 text-indigo-200 border border-indigo-600/30",children:"YOU"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-[11px] text-slate-400",children:"Score"}),t.jsx("div",{className:"text-sm font-bold text-emerald-300",children:f.score})]}),t.jsxs("div",{className:"min-w-[68px]",children:[t.jsx("div",{className:"text-[11px] text-slate-400",children:"Prize"}),t.jsxs("div",{className:"text-sm font-bold text-purple-300 flex items-center justify-end gap-1",children:[ae.showIconSeparately&&ae.icon&&t.jsx("span",{"aria-hidden":"true",children:ae.icon}),t.jsx("span",{children:ae.formatted})]})]})]})]}),Array.isArray(i==null?void 0:i.prizes)&&i.prizes.length>0&&t.jsx("div",{className:"rounded-xl border border-slate-800 bg-slate-900/60 p-3 mb-4 overflow-x-auto whitespace-nowrap",children:i.prizes.map((s,a)=>{const l=de(se,s,{fallback:0}),e=l.showIconSeparately&&l.icon?`${l.icon} `:"";return t.jsxs("span",{className:`inline-block mr-2 mb-2 px-2.5 py-1 rounded-lg text-xs font-semibold border ${a===0?"bg-amber-500/10 text-amber-200 border-amber-500/30":a===1?"bg-sky-500/10 text-sky-200 border-sky-500/30":a===2?"bg-violet-500/10 text-violet-200 border-violet-500/30":"bg-slate-800/60 text-slate-200 border-slate-700"}`,children:[a===0?"ðŸ¥‡ 1st":a===1?"ðŸ¥ˆ 2nd":a===2?"ðŸ¥‰ 3rd":`#${a+1}`," â€¢ ",`${e}${l.formatted}`.trim()]},a)})}),t.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-900/60 p-3",children:[t.jsxs("div",{className:"text-sm font-semibold text-white mb-2 flex items-center gap-2",children:[t.jsx(Fe,{className:"w-4 h-4 text-amber-300"}),"Leaderboard"]}),t.jsx("div",{className:"space-y-2",children:z.map((s,a)=>{var d,n,h,m,b,v,u;const l=s.rank&&Array.isArray(i==null?void 0:i.prizes)&&i.prizes[s.rank-1]?i.prizes[s.rank-1]:0,e=de(se,l,{fallback:0}),g=s.user_id===(j==null?void 0:j.id);return t.jsxs(_t.div,{variants:Je,initial:"hidden",animate:"show",className:`flex items-center justify-between p-2.5 rounded-lg border transition-colors ${g?"bg-indigo-950/40 border-indigo-700/40 ring-1 ring-indigo-500/20":a<3?"bg-slate-900/70 border-slate-700/60":"bg-slate-950/30 border-slate-800 hover:bg-slate-900/60"}`,children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("div",{className:"w-8 h-8 rounded-md grid place-items-center text-xs font-bold bg-slate-800 text-slate-100 ring-1 ring-white/10",children:t.jsx("span",{children:s.rank||a+1})}),t.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center text-gray-600 text-xs font-bold",children:(d=s.profiles)!=null&&d.avatar_url?t.jsx("img",{src:s.profiles.avatar_url,alt:s.profiles.full_name?`${s.profiles.full_name} avatar`:"User avatar",className:"w-full h-full object-cover",loading:"lazy",decoding:"async"}):t.jsx("span",{children:(((n=s.profiles)==null?void 0:n.full_name)||((h=s.profiles)==null?void 0:h.username)||"U").charAt(0).toUpperCase()})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-white truncate",children:((m=s.profiles)==null?void 0:m.username)||((b=s.profiles)==null?void 0:b.full_name)||"Anonymous"}),((v=s.profiles)==null?void 0:v.full_name)&&((u=s.profiles)==null?void 0:u.username)&&t.jsx("p",{className:"text-[10px] text-slate-400 truncate",children:s.profiles.full_name})]})]}),t.jsxs("div",{className:"flex items-center gap-5 shrink-0",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm font-bold text-emerald-300 leading-none",children:s.score}),t.jsx("p",{className:"text-[10px] text-slate-400 leading-none",children:"Score"})]}),t.jsxs("div",{className:"text-right min-w-[64px]",children:[t.jsxs("p",{className:"text-sm font-bold text-purple-300 leading-none flex items-center justify-end gap-1",children:[e.showIconSeparately&&e.icon&&t.jsx("span",{"aria-hidden":"true",children:e.icon}),t.jsx("span",{children:e.formatted})]}),t.jsx("p",{className:"text-[10px] text-slate-400 leading-none",children:"Prize"})]})]})]},s.id)})})]})]}),t.jsx("div",{className:"fixed inset-x-0 bottom-0 z-40 border-t border-slate-800 bg-slate-900/90 backdrop-blur supports-[backdrop-filter]:bg-slate-900/70 shadow-[0_-6px_24px_rgba(0,0,0,0.35)]",children:t.jsx("div",{className:"max-w-4xl mx-auto px-3 sm:px-4",style:{paddingTop:10,paddingBottom:"calc(env(safe-area-inset-bottom, 0px) + 10px)"},children:t.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center",children:[t.jsxs("button",{onClick:()=>K("/my-quizzes"),className:"col-span-1 inline-flex items-center justify-center gap-2 h-12 px-3 rounded-lg text-sm font-semibold bg-slate-800/85 text-white border border-slate-700 hover:bg-slate-800 active:translate-y-px transition w-full min-w-0",children:[t.jsx(yt,{className:"w-5 h-5","aria-hidden":"true"}),t.jsx("span",{className:"truncate",children:"Back"})]}),t.jsxs("button",{onClick:et,className:"col-span-1 inline-flex items-center justify-center gap-2 h-12 px-2.5 rounded-lg text-[13px] sm:text-sm font-extrabold border text-white shadow-[0_8px_18px_rgba(34,197,94,0.35)] hover:shadow-[0_12px_24px_rgba(34,197,94,0.5)] border-emerald-500/50 bg-[linear-gradient(90deg,#16a34a,#22c55e,#10b981)] w-full min-w-0",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{fill:"currentColor",d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.272-.099-.471-.148-.67.149-.198.297-.768.966-.941 1.164-.173.198-.347.223-.644.074-.297-.149-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.149-.173.198-.297.297-.495.099-.198.05-.372-.025-.521-.074-.149-.669-1.611-.916-2.205-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.521.074-.793.372s-1.042 1.016-1.042 2.479 1.067 2.876 1.219 3.074c.149.198 2.1 3.2 5.077 4.487.709.306 1.262.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.718 2.007-1.41.248-.694.248-1.289.173-1.41-.074-.123-.272-.198-.57-.347m-5.49 7.485h-.004a9.867 9.867 0 01-5.031-1.378l-.361-.214-3.741.982.999-3.648-.235-.374a9.861 9.861 0 01-1.51-5.241c.001-5.45 4.434-9.884 9.885-9.884 2.641 0 5.122 1.03 6.988 2.897a9.825 9.825 0 012.897 6.994c-.003 5.45-4.436 9.884-9.887 9.884m8.413-18.297A11.815 11.815 0 0012.004 0C5.375 0 .16 5.215.157 11.844a11.82 11.82 0 001.624 5.99L0 24l6.305-1.654a11.86 11.86 0 005.68 1.448h.005c6.628 0 11.843-5.215 11.846-11.844a11.787 11.787 0 00-3.473-8.372z"})}),t.jsx("span",{className:"whitespace-nowrap",children:"WhatsApp"})]}),t.jsxs("button",{onClick:Ze,className:"col-span-1 inline-flex items-center justify-center gap-2 h-12 px-3 rounded-lg text-sm font-extrabold border text-white shadow-[0_8px_18px_rgba(139,92,246,0.4)] hover:shadow-[0_12px_24px_rgba(139,92,246,0.55)] border-violet-500/40 bg-[linear-gradient(90deg,#4f46e5,#7c3aed,#9333ea,#c026d3)] w-full min-w-0",children:[t.jsx(Nt,{className:"w-5 h-5","aria-hidden":"true"}),t.jsx("span",{className:"truncate",children:"Share"})]})]})})})]})};export{Ut as default};
