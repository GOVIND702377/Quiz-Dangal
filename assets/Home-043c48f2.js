import{u as q,a as _,s as j,j as t,S as N}from"./index-b6b68c05.js";import{r as l}from"./react-8a702e3e.js";import{S}from"./SEO-bb158803.js";import{a as k}from"./router-f2cf3f51.js";import{m as b}from"./motion-511bde03.js";import{b as C,B as D,T as E,c as L}from"./icons-5fed0bfb.js";import"./supabase-4c1332f7.js";const P=[{title:"Opinion",slug:"opinion",icon:C},{title:"G.K Knowledge",slug:"gk",icon:D},{title:"Sports",slug:"sports",icon:E},{title:"Movies",slug:"movies",icon:L}],T=({tile:n,quizzes:d,onJoin:y,index:x,joiningId:w,onOpenList:z,navigateTo:m})=>{const u=Date.now(),g=d.filter(s=>(s.category||"").toLowerCase()===n.slug.toLowerCase()).filter(s=>{const o=s.start_time?new Date(s.start_time).getTime():0,e=s.end_time?new Date(s.end_time).getTime():0,i=o&&e&&u>=o&&u<e,a=o&&u<o;return i||a}).sort((s,o)=>new Date(s.start_time||s.end_time||0)-new Date(o.start_time||o.end_time||0)),c=g[0];g.length,w&&c&&c.id;const v=n.icon,p=["neon-orange","neon-purple","neon-teal","neon-pink"],f="PLAY";return t.jsx(b.button,{type:"button",initial:{opacity:0,scale:.96},animate:{opacity:1,scale:1},transition:{duration:.25,delay:x*.06},onClick:()=>m(n.slug),className:`neon-card ${p[x%p.length]} group aspect-square w-full rounded-xl focus:outline-none will-change-transform transform-gpu transition-transform hover:scale-[1.02] hover:shadow-xl relative`,style:{borderRadius:"0.75rem"},"aria-label":`${n.title} - Play`,children:t.jsx("div",{className:"neon-card-content select-none flex items-center justify-center",children:t.jsxs("div",{className:"w-full flex flex-col items-center justify-center gap-2",children:[t.jsx(v,{className:"w-8 h-8 text-white drop-shadow"}),t.jsx("h3",{className:"text-base font-extrabold leading-tight text-white text-shadow-sm text-center",children:n.title}),t.jsx("span",{className:"play-pill group-hover:shadow-lg group-hover:brightness-110",children:f})]})})})},$=()=>{const{toast:n}=q(),d=k(),{user:y,userProfile:x,refreshUserProfile:w}=_(),[z,m]=l.useState([]),[u,g]=l.useState(!0),[c,v]=l.useState({open:!1,day:0,coins:0});l.useRef(!1);const[p,f]=l.useState(null),s=l.useCallback(async()=>{try{const{data:e,error:i}=await j.from("quizzes").select("id,title,category,start_time,end_time,status,prize_pool,prizes").order("start_time",{ascending:!0});if(i)throw i;m(e||[])}catch(e){console.error(e),n({title:"Error",description:"Could not fetch quizzes.",variant:"destructive"}),m([])}finally{g(!1)}},[n]);l.useEffect(()=>{s();const e=setInterval(s,6e4);return()=>clearInterval(e)},[s]);const o=async e=>{if(!(!e||p===e.id)){if(!y){n({title:"Login required",description:"Please sign in to join the quiz.",variant:"destructive"}),d("/login");return}f(e.id);try{const i=e.status==="upcoming"?"pre_join_quiz":"join_quiz",{data:a,error:r}=await j.rpc(i,{p_quiz_id:e.id});if(r)throw r;if(e.status==="upcoming")n({title:"Pre-joined!",description:"We will remind you 1 minute before start."});else{if(a&&a!=="Joined Successfully")throw new Error(a);n({title:"Joined!",description:"Redirecting you to the quiz."}),d(`/quiz/${e.id}`)}}catch(i){const a=String((i==null?void 0:i.message)||"").toLowerCase();let r=(i==null?void 0:i.message)||"Could not join quiz.",h="Error";a.includes("not authenticated")?(h="Login required",r="Please sign in to join the quiz."):a.includes("insufficient balance")?(h="Insufficient balance",r="You do not have enough coins to join this quiz."):a.includes("quiz not active")&&(h="Quiz not active",r="This quiz is not active right now."),n({title:h,description:r,variant:"destructive"})}finally{f(null)}}};return t.jsxs("div",{className:"h-full relative overflow-hidden",children:[t.jsx(S,{title:"Quiz Dangal – Play Quiz & Win Rewards | Opinion, GK, Sports, Movies",description:"Play daily opinion-based quizzes on Quiz Dangal. Win coins, climb leaderboards, and refer & earn with friends. India’s top play & win quiz app.",canonical:"https://quizdangal.com/",keywords:["Quiz Dangal","quizdangal","quiz app","play quiz and win","opinion quiz","daily quiz India","refer and earn quiz","win rewards","leaderboards","online quiz contest"]}),t.jsx("div",{className:"relative z-10 h-full flex items-center justify-center px-4 mt-1 sm:mt-2 mb-6",children:t.jsxs("div",{className:"w-full max-w-[420px]",children:[t.jsxs(b.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.25},className:"text-center mb-4",children:[t.jsx("h1",{className:"text-xl font-extrabold tracking-tight bg-gradient-to-r from-indigo-200 via-fuchsia-200 to-pink-200 bg-clip-text text-transparent",children:"Brain games, real gains. Ready to shine?"}),t.jsx("p",{className:"text-[13px] text-slate-300/90 mt-1",children:"Compete, earn, repeat — where winners never chill out."}),t.jsx("div",{className:"mx-auto mt-2 h-[2px] w-24 rounded-full bg-gradient-to-r from-indigo-400/60 via-fuchsia-400/60 to-pink-400/60"})]}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:u?Array.from({length:4}).map((e,i)=>t.jsx("div",{className:"aspect-square w-full rounded-xl bg-slate-800/60 border border-slate-700/60 animate-pulse"},i)):P.map((e,i)=>t.jsx(T,{tile:e,quizzes:z,onJoin:o,index:i,joiningId:p,navigateTo:a=>d(`/category/${a}`)},e.slug))})]})}),t.jsx(N,{open:c.open,day:c.day,coins:c.coins,onClose:()=>v(e=>({...e,open:!1}))})]})};export{$ as default};
