import{u as xe,a as be,s as A,j as t,B as E}from"./index-4129f435.js";import{r as C}from"./react-8a702e3e.js";import{g as ye}from"./avatar-c8ac4c51.js";import{c as we,a as ve}from"./router-bcacfb8d.js";import{d as je,T as Se,Z as Ne,_ as _e,f as Ce}from"./icons-68c1f3a5.js";import"./supabase-4c1332f7.js";import"./motion-511bde03.js";const Ee=()=>{const{id:j}=we(),P=ve(),{toast:T}=xe(),{user:b,userProfile:h}=be(),[n,ae]=C.useState(null),[N,D]=C.useState([]),[d,re]=C.useState(null),[q,M]=C.useState(!0),[K,B]=C.useState(""),[Re,oe]=C.useState(!0),[ee,z]=C.useState(null),[ne,le]=C.useState(!1),[te,Q]=C.useState(null);C.useEffect(()=>{F()},[j]);const F=async()=>{try{B("");const{data:s}=await A.from("quizzes").select("*").eq("id",j).single();if(ae(s||null),(h==null?void 0:h.role)!=="admin")try{const{data:p}=await A.from("quiz_participants").select("status").eq("quiz_id",j).eq("user_id",b==null?void 0:b.id).maybeSingle(),i=!!p;if(oe(i),!i){B("You did not participate in this quiz. Results are visible only to participants."),M(!1);return}}catch(p){}const{data:a,error:r}=await A.from("quiz_results").select("leaderboard").eq("quiz_id",j).maybeSingle();if(r)throw r;const o=Array.isArray(a==null?void 0:a.leaderboard)?a.leaderboard:[];if(!a||o.length===0){if(D([]),s!=null&&s.end_time){const i=new Date(s.end_time).getTime()-Date.now();if(z(i>0?i:0),i<=0)try{await A.rpc("compute_results_if_due",{p_quiz_id:j}),await new Promise(f=>setTimeout(f,500));const{data:y}=await A.from("quiz_results").select("leaderboard").eq("quiz_id",j).maybeSingle(),c=Array.isArray(y==null?void 0:y.leaderboard)?y.leaderboard:[];if(c.length>0){const f=c.map((m,x)=>{var w;return{id:`${j}-${m.user_id}`,user_id:m.user_id,score:Number(m.score)||0,rank:Number(m.rank)||x+1,profiles:{username:(w=m.display_name)!=null&&w.startsWith("@")?m.display_name.slice(1):void 0,full_name:m.display_name,avatar_url:void 0}}}).sort((m,x)=>x.score-m.score);D(f),M(!1);return}}catch(y){}}else z(null);return}const l=o.map((p,i)=>{var y;return{id:`${j}-${p.user_id}`,user_id:p.user_id,score:Number(p.score)||0,rank:Number(p.rank)||i+1,profiles:{username:(y=p.display_name)!=null&&y.startsWith("@")?p.display_name.slice(1):void 0,full_name:p.display_name,avatar_url:void 0}}}).sort((p,i)=>i.score-p.score);D(l);try{const p=l.slice(0,10).map(i=>i.user_id);if(p.length){const{data:i,error:y}=await A.rpc("profiles_public_by_ids",{p_ids:p});if(y&&console.warn("Public profile fetch failed:",y),Array.isArray(i)&&i.length){const c=new Map(i.map(m=>[m.id,m])),f=await ye(i.map(m=>m.avatar_url).filter(Boolean));D(m=>m.map(x=>{const w=c.get(x.user_id);if(!w)return x;const S=w.avatar_url&&f.get(w.avatar_url)||"";return{...x,profiles:{username:w.username,full_name:w.full_name,avatar_url:S}}}))}}}catch(p){}const e=l.find(p=>p.user_id===(b==null?void 0:b.id));e&&re(e)}catch(s){console.error("Error fetching results:",s),B((s==null?void 0:s.message)||"Failed to load results.")}finally{M(!1)}},se=()=>{M(!0),B(""),F()};C.useEffect(()=>{let s=!1;return(async()=>{try{if(N.length===0){Q(null);return}const r=await O();s||Q(r)}catch(r){s||Q(null)}})(),()=>{s=!0}},[N.length,j,d==null?void 0:d.rank,d==null?void 0:d.score]);const Y=async()=>{const s=(typeof window!="undefined"?window.location.origin:"")+"/",a={}.VITE_RESULTS_POSTER_URL,r={}.VITE_REFER_POSTER_URL,o=Date.now(),l=c=>c!=null&&c.startsWith("http")?c:`${s}${c.replace(/^\//,"")}`,e=c=>c.includes("?")?`${c}&v=${o}`:`${c}?v=${o}`,p=(a?[e(l(a))]:["/result poster.png","/results poster.png","/result share poster.png","/result share.png","/result card.png","/result-poster.png","/results-poster.png","/result.png","/results.png","/result.webp","/results.webp","/result%20poster.png","/results%20poster.png","/result%20share%20poster.png","/result%20share.png","/result%20card.png","/images/result poster.png","/images/results poster.png","/images/result-poster.png","/images/results-poster.png","/assets/result poster.png","/assets/results poster.png","/assets/result-poster.png","/assets/results-poster.png","/posters/result poster.png","/posters/results poster.png","/posters/result-poster.png","/posters/results-poster.png"]).map(c=>e(l(c))),i=(r?[e(l(r))]:["/refer & earn poster.png","/refer%20%26%20earn%20poster.png","/refer-poster.png","/refer-poster.jpg","/refer-poster.jpeg","/refer.jpg","/refer.png","/refer.webp","/images/refer-poster.png","/images/refer-poster.jpg","/images/refer-poster.jpeg","/images/refer-poster.webp","/assets/refer-poster.png","/assets/refer-poster.jpg","/assets/refer-poster.jpeg","/assets/refer-poster.webp","/posters/refer-poster.png","/posters/refer-poster.jpg","/posters/refer-poster.jpeg","/posters/refer-poster.webp"]).map(c=>e(l(c))),y=[...p,...i];for(const c of y)try{const f=await fetch(c,{cache:"reload"});if(!f.ok)throw new Error("not ok");const m=await f.blob();if(m&&m.size>0&&/^image\//.test(m.type||"")){if((m.type||"image/jpeg").toLowerCase()!=="image/jpeg")try{const w=URL.createObjectURL(m),S=await new Promise((L,G)=>{const I=new Image;I.onload=()=>L(I),I.onerror=G,I.src=w}),U=document.createElement("canvas");U.width=S.width,U.height=S.height,U.getContext("2d").drawImage(S,0,0);const k=await new Promise(L=>U.toBlob(L,"image/jpeg",.92));if(URL.revokeObjectURL(w),k)return k}catch(w){}return m}}catch(f){}try{const c=document.createElement("canvas");c.width=8,c.height=8;const f=c.getContext("2d");return f.fillStyle="#2b0b76",f.fillRect(0,0,8,8),await new Promise(x=>c.toBlob(x,"image/jpeg",.92))}catch(c){return null}},O=async()=>{try{const s=await Y(),a=s?URL.createObjectURL(s):null,r=1080,o=1080,l=document.createElement("canvas");l.width=r,l.height=o;const e=l.getContext("2d");if(a)try{const g=await new Promise((fe,he)=>{const W=new Image;W.onload=()=>fe(W),W.onerror=he,W.src=a}),u=r/o,_=g.width/g.height;let R=r,v=o,Z=0,X=0;_>u?(v=o,R=o*_,Z=(r-R)/2,X=0):(R=r,v=r/_,Z=0,X=(o-v)/2),e.drawImage(g,Z,X,R,v)}catch(g){const u=e.createLinearGradient(0,0,r,o);u.addColorStop(0,"#130531"),u.addColorStop(1,"#1e0b4b"),e.fillStyle=u,e.fillRect(0,0,r,o)}finally{a&&URL.revokeObjectURL(a)}else{const g=e.createLinearGradient(0,0,r,o);g.addColorStop(0,"#130531"),g.addColorStop(1,"#1e0b4b"),e.fillStyle=g,e.fillRect(0,0,r,o)}const p=e.createRadialGradient(r/2,o/2,o*.2,r/2,o/2,o*.7);p.addColorStop(0,"rgba(0,0,0,0)"),p.addColorStop(1,"rgba(0,0,0,0.35)"),e.fillStyle=p,e.fillRect(0,0,r,o);const i=64;e.fillStyle="rgba(255,255,255,0.92)",e.font="800 58px Inter, system-ui, -apple-system, Segoe UI, Roboto";const y=n!=null&&n.title?String(n.title).toUpperCase():"QUIZ DANGAL RESULTS",c=r-i*2,f=g=>e.measureText(g).width;let m=y;for(;m.length>0&&f(m)>c;)m=m.slice(0,-1);if(m!==y&&(m+="â€¦"),e.fillText(m,i,i),Array.isArray(N)){const g=`${N.length} participants`;e.fillStyle="rgba(203,213,225,0.85)",e.font="600 28px Inter, system-ui, -apple-system, Segoe UI, Roboto";const u=e.measureText(g).width;e.fillText(g,r-i-u,i)}const x=i,w=i+80,S=r-i*2,U=380,H=36,k=(g,u,_,R,v)=>{e.beginPath(),e.moveTo(g+v,u),e.lineTo(g+_-v,u),e.quadraticCurveTo(g+_,u,g+_,u+v),e.lineTo(g+_,u+R-v),e.quadraticCurveTo(g+_,u+R,g+_-v,u+R),e.lineTo(g+v,u+R),e.quadraticCurveTo(g,u+R,g,u+R-v),e.lineTo(g,u+v),e.quadraticCurveTo(g,u,g+v,u),e.closePath()};e.save(),e.shadowColor="rgba(236,72,153,0.6)",e.shadowBlur=28,k(x,w,S,U,H),e.fillStyle="rgba(15,23,42,0.72)",e.fill(),e.restore(),e.lineWidth=3,e.strokeStyle="rgba(236,72,153,0.6)",k(x,w,S,U,H),e.stroke();const L=d!=null&&d.rank?`#${d.rank} Rank!`:"Results Live!";e.fillStyle="#ffffff",e.font="900 120px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText(L,x+48,w+150);const G=d!=null&&d.rank&&Array.isArray(n==null?void 0:n.prizes)&&n.prizes[d.rank-1]?n.prizes[d.rank-1]:0;e.fillStyle="rgba(255,255,255,0.92)",e.font="700 40px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText(`Prize: â‚¹${G}`,x+50,w+210),typeof(d==null?void 0:d.score)=="number"&&(e.fillStyle="rgba(168, 255, 230, 0.95)",e.font="800 64px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText(`Score: ${d.score}`,x+50,w+280));{const g=((h==null?void 0:h.username)||(h==null?void 0:h.full_name)||"You").toString();e.fillStyle="rgba(226,232,240,0.92)",e.font="700 34px Inter, system-ui, -apple-system, Segoe UI, Roboto";let u=g;const _=S-100;for(;u.length>0&&e.measureText(u).width>_;)u=u.slice(0,-1);u!==g&&(u+="â€¦"),e.fillText(`Player: ${u}`,x+50,w+328)}e.fillStyle="rgba(226,232,240,0.92)",e.font="600 30px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText("Only legends make it this far âœ¨",x+50,w+U-50);const I=w+U+24,V=90;e.save(),e.shadowColor="rgba(59,130,246,0.5)",e.shadowBlur=15,k(x,I,S,V,22),e.fillStyle="rgba(2,6,23,0.75)",e.fill(),e.restore(),e.strokeStyle="rgba(59,130,246,0.5)",e.lineWidth=2,k(x,I,S,V,22),e.stroke(),e.fillStyle="rgba(250,204,21,0.95)",e.font="900 40px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText("âš¡ My Result is Live!",x+36,I+58);const $=I+V+24,J=o-$-i;k(x,$,S,J,24),e.fillStyle="rgba(2,6,23,0.7)",e.fill(),e.strokeStyle="rgba(147,51,234,0.45)",e.lineWidth=2,k(x,$,S,J,24),e.stroke();const ge=(h==null?void 0:h.referral_code)||((b==null?void 0:b.id)||"").replace(/-/g,"").slice(0,8).toUpperCase(),ue=({}.VITE_PUBLIC_SITE_URL||"https://quizdangal.com").replace(/\/$/,"");return e.fillStyle="rgba(255,255,255,0.95)",e.font="800 44px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText("Play & Win on Quiz Dangal",x+36,$+64),e.fillStyle="rgba(203,213,225,0.98)",e.font="700 36px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText(ue.replace(/^https?:\/\//,""),x+36,$+64+46),e.fillStyle="rgba(190,242,100,1)",e.font="900 42px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText(`Referral: ${ge}`,x+36,$+64+46+52),e.fillStyle="rgba(203,213,225,0.9)",e.font="600 26px Inter, system-ui, -apple-system, Segoe UI, Roboto",e.fillText("#QuizDangal  #ChallengeAccepted  #PlayToWin",x+36,$+J-36),await new Promise(g=>l.toBlob(g,"image/jpeg",.92))}catch(s){return await Y()}},ie=async()=>{var s;try{const a=/iPhone|iPad|iPod/i.test(navigator.userAgent),r=(h==null?void 0:h.referral_code)||((b==null?void 0:b.id)||"").replace(/-/g,"").slice(0,8),{shareText:o}=me(),l=["ðŸ”¥ My result is here! ðŸ”¥","Checked out the poster? Now itâ€™s your turn ðŸ‘€","","ðŸ‘‰ Just head over to www.quizdangal.com",`Use Referral Code: ${r}`,"and unlock your score ðŸš€","","Donâ€™t just scroll, share your vibes ðŸ’¯","#Results #ChallengeAccepted"].join(`
`),e=`My result on Quiz Dangal â€” Use code: ${r} â€” quizdangal.com`,i=te||await O(),y=`quizdangal-result-${j}-${(s=d==null?void 0:d.rank)!=null?s:"NA"}.jpg`,c=i?[new File([i],y,{type:"image/jpeg"})]:[];try{await navigator.clipboard.writeText(a?e:l)}catch(m){}const f=c.length>0&&typeof navigator.canShare=="function"&&(()=>{try{return navigator.canShare({files:c})}catch(m){return!1}})();if(typeof navigator.share=="function"){if(f){a?(await navigator.share({text:e,files:c}),T({title:"Caption copied",description:"If the app didn't include it, just paste."})):await navigator.share({text:l,files:c});return}await navigator.share({text:o||l});return}T({title:"Sharing not supported",description:"Caption copied. Use WhatsApp button or paste into your app."})}catch(a){T({title:"Share failed",description:(a==null?void 0:a.message)||"Try again",variant:"destructive"})}},ce=async()=>{var s;try{const a=/iPhone|iPad|iPod/i.test(navigator.userAgent),r=(h==null?void 0:h.referral_code)||((b==null?void 0:b.id)||"").replace(/-/g,"").slice(0,8),o=["ðŸ”¥ My result is here! ðŸ”¥","Checked out the poster? Now itâ€™s your turn ðŸ‘€","","ðŸ‘‰ Just head over to www.quizdangal.com",`Use Referral Code: ${r}`,"and unlock your score ðŸš€","","Donâ€™t just scroll, share your vibes ðŸ’¯","#Results #ChallengeAccepted"].join(`
`),l=`My result on Quiz Dangal â€” Use code: ${r} â€” quizdangal.com`,e=await O(),p=`quizdangal-result-${j}-${(s=d==null?void 0:d.rank)!=null?s:"NA"}.jpg`,i=e?[new File([e],p,{type:"image/jpeg"})]:[];try{await navigator.clipboard.writeText(a?l:o)}catch(f){}const y=i.length>0&&typeof navigator.canShare=="function"&&(()=>{try{return navigator.canShare({files:i})}catch(f){return!1}})();if(typeof navigator.share=="function"&&y){await navigator.share({text:a?l:o,files:i}),a&&T({title:"Choose WhatsApp",description:"If caption is missing, paste from clipboard."});return}if(e){const f=document.createElement("a");f.href=URL.createObjectURL(e),f.download=p,document.body.appendChild(f),f.click(),f.remove(),setTimeout(()=>URL.revokeObjectURL(f.href),5e3)}const c=encodeURIComponent(a?l:o);window.open(`https://wa.me/?text=${c}`,"_blank"),T({title:"Image saved",description:"WhatsApp khul gaya. Image attach karke caption paste kar dijiye."})}catch(a){T({title:"WhatsApp share failed",description:(a==null?void 0:a.message)||"Try again",variant:"destructive"})}},de=async()=>{var s;try{const r=te||await O()||await Y();if(!r){T({title:"Download failed",description:"Could not generate poster. Try again.",variant:"destructive"});return}const o=`quizdangal-result-${j}-${(s=d==null?void 0:d.rank)!=null?s:"NA"}.jpg`,l=document.createElement("a");l.href=URL.createObjectURL(r),l.download=o,document.body.appendChild(l),l.click(),l.remove(),setTimeout(()=>URL.revokeObjectURL(l.href),5e3),T({title:"Poster downloaded",description:"Share it in your app and paste the caption."})}catch(a){T({title:"Download failed",description:(a==null?void 0:a.message)||"Try again",variant:"destructive"})}};C.useEffect(()=>{if(!(n!=null&&n.end_time)||N.length>0){z(null);return}const s=new Date(n.end_time).getTime(),a=()=>{const o=s-Date.now();o>0?z(o):(z(0),ne||(le(!0),F()))};a();const r=setInterval(a,1e3);return()=>clearInterval(r)},[n==null?void 0:n.end_time,N.length]);const pe=s=>{const a=Math.max(0,Math.floor((s!=null?s:0)/1e3)),r=Math.floor(a/86400),o=Math.floor(a%86400/3600),l=Math.floor(a%3600/60),e=a%60;return{days:r,hours:o,minutes:l,seconds:e}},me=()=>{const s=(h==null?void 0:h.referral_code)||((b==null?void 0:b.id)||"").replace(/-/g,"").slice(0,8),r=({}.VITE_PUBLIC_SITE_URL||"https://quizdangal.com").replace(/\/$/,""),o=`${r}/results/${j}?ref=${encodeURIComponent(s)}`,l=d?`I scored ${d.score} and rank #${d.rank} in ${(n==null?void 0:n.title)||"Quiz"} on Quiz Dangal! Play now: ${o}`:`Check out the results of ${(n==null?void 0:n.title)||"Quiz"} on Quiz Dangal! ${o}`;return{refCode:s,site:r,resultUrl:o,shareText:l}};return q?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-accent-b"})}):!q&&K?t.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",children:t.jsxs("div",{className:"qd-card rounded-2xl p-6 shadow-lg text-center max-w-md w-full text-slate-100",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2 text-white",children:"Couldn\\'t load results"}),t.jsx("p",{className:"text-slate-300 mb-4",children:K}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(E,{variant:"brand",onClick:se,children:"Retry"}),t.jsx(E,{variant:"white",onClick:()=>P("/my-quizzes"),children:"Back"})]})]})}):!q&&N.length===0?t.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",children:t.jsxs("div",{className:"qd-card rounded-2xl p-6 shadow-lg text-center max-w-md w-full text-slate-100",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2 text-white",children:"Results not published yet"}),n!=null&&n.end_time?t.jsx("div",{className:"mb-4",children:ee>0?t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-300 mb-3",children:"Quiz ends in"}),(()=>{const{days:s,hours:a,minutes:r,seconds:o}=pe(ee),l=(e,p)=>t.jsxs("div",{className:"px-3 py-2 rounded-md bg-slate-800/70 border border-slate-700 min-w-[64px]",children:[t.jsx("div",{className:"text-xl font-bold text-white tabular-nums",children:e.toString().padStart(2,"0")}),t.jsx("div",{className:"text-xs text-slate-400",children:p})]});return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s>0&&l(s,"Days"),l(a,"Hours"),l(r,"Minutes"),l(o,"Seconds")]})})(),t.jsxs("p",{className:"text-xs text-slate-400 mt-3",children:["End time: ",new Date(n.end_time).toLocaleString()]})]}):t.jsx("p",{className:"text-slate-300 mb-4",children:"Finalizing resultsâ€¦ please stay on this page."})}):t.jsx("p",{className:"text-slate-300 mb-4",children:"Please check back after the quiz end time."}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(E,{variant:"brand",onClick:se,children:"Refresh"}),t.jsx(E,{variant:"white",onClick:()=>P("/my-quizzes"),children:"Back to My Quizzes"}),t.jsx(E,{variant:"white",onClick:()=>P("/"),children:"Go Home"})]})]})}):t.jsx("div",{className:"min-h-screen p-4",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-slate-300 text-xs mb-1",children:[t.jsx(je,{className:"w-3.5 h-3.5"}),t.jsxs("span",{children:[(N==null?void 0:N.length)||0," participants"]})]}),t.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white truncate",children:"Results"}),t.jsx("p",{className:"text-xs text-slate-400 truncate",children:n==null?void 0:n.title})]}),d&&(h==null?void 0:h.role)!=="admin"&&t.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-900/60 p-3 mb-4 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-indigo-500 via-violet-500 to-fuchsia-600 text-white font-bold flex items-center justify-center ring-1 ring-indigo-300/40",children:["#",d.rank]}),t.jsxs("div",{className:"text-xs text-slate-300",children:[t.jsx("div",{className:"text-white font-semibold",children:"Your Result"}),t.jsxs("div",{children:["Out of ",N.length," participants"]})]})]}),t.jsxs("div",{className:"flex items-center gap-3 text-center",children:[t.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-semibold bg-indigo-500/15 text-indigo-200 border border-indigo-600/30",children:"YOU"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-[11px] text-slate-400",children:"Score"}),t.jsx("div",{className:"text-sm font-bold text-emerald-300",children:d.score})]}),t.jsxs("div",{className:"min-w-[68px]",children:[t.jsx("div",{className:"text-[11px] text-slate-400",children:"Prize"}),t.jsxs("div",{className:"text-sm font-bold text-purple-300",children:["â‚¹",d.rank&&Array.isArray(n==null?void 0:n.prizes)&&n.prizes[d.rank-1]?n.prizes[d.rank-1]:0]})]})]})]}),Array.isArray(n==null?void 0:n.prizes)&&n.prizes.length>0&&t.jsx("div",{className:"rounded-xl border border-slate-800 bg-slate-900/60 p-3 mb-4 overflow-x-auto whitespace-nowrap",children:n.prizes.map((s,a)=>t.jsxs("span",{className:`inline-block mr-2 mb-2 px-2.5 py-1 rounded-lg text-xs font-semibold border ${a===0?"bg-amber-500/10 text-amber-200 border-amber-500/30":a===1?"bg-sky-500/10 text-sky-200 border-sky-500/30":a===2?"bg-violet-500/10 text-violet-200 border-violet-500/30":"bg-slate-800/60 text-slate-200 border-slate-700"}`,children:[a===0?"ðŸ¥‡ 1st":a===1?"ðŸ¥ˆ 2nd":a===2?"ðŸ¥‰ 3rd":`#${a+1}`," â€¢ â‚¹",s]},a))}),t.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-900/60 p-3",children:[t.jsxs("div",{className:"text-sm font-semibold text-white mb-2 flex items-center gap-2",children:[t.jsx(Se,{className:"w-4 h-4 text-amber-300"}),"Leaderboard"]}),t.jsx("div",{className:"space-y-2",children:N.map((s,a)=>{var l,e,p,i,y,c,f;const r=s.rank&&Array.isArray(n==null?void 0:n.prizes)&&n.prizes[s.rank-1]?n.prizes[s.rank-1]:0,o=s.user_id===(b==null?void 0:b.id);return t.jsxs("div",{className:`flex items-center justify-between p-2.5 rounded-lg border transition-colors ${o?"bg-indigo-950/40 border-indigo-700/40":"bg-slate-950/30 border-slate-800 hover:bg-slate-900/60"}`,children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("div",{className:`w-8 h-8 rounded-md flex items-center justify-center text-xs font-bold ${a<3?"bg-gradient-to-br from-amber-300 to-yellow-500 text-amber-900 ring-1 ring-amber-200/60":"bg-slate-800 text-slate-100 ring-1 ring-white/10"}`,children:a+1}),t.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center text-gray-600 text-xs font-bold",children:(l=s.profiles)!=null&&l.avatar_url?t.jsx("img",{src:s.profiles.avatar_url,alt:"avatar",className:"w-full h-full object-cover"}):t.jsx("span",{children:(((e=s.profiles)==null?void 0:e.full_name)||((p=s.profiles)==null?void 0:p.username)||"U").charAt(0).toUpperCase()})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-white truncate",children:((i=s.profiles)==null?void 0:i.username)||((y=s.profiles)==null?void 0:y.full_name)||"Anonymous"}),((c=s.profiles)==null?void 0:c.full_name)&&((f=s.profiles)==null?void 0:f.username)&&t.jsx("p",{className:"text-[10px] text-slate-400 truncate",children:s.profiles.full_name})]})]}),t.jsxs("div",{className:"flex items-center gap-5 shrink-0",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm font-bold text-emerald-300 leading-none",children:s.score}),t.jsx("p",{className:"text-[10px] text-slate-400 leading-none",children:"Score"})]}),t.jsxs("div",{className:"text-right min-w-[64px]",children:[t.jsxs("p",{className:"text-sm font-bold text-purple-300 leading-none",children:["â‚¹",r]}),t.jsx("p",{className:"text-[10px] text-slate-400 leading-none",children:"Prize"})]})]})]},s.id)})})]}),t.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[t.jsxs("button",{onClick:()=>P("/my-quizzes"),className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold bg-slate-800/70 text-white border border-slate-700 hover:bg-slate-800",children:[t.jsx(Ne,{className:"w-4 h-4"})," Back"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:ce,className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold bg-emerald-600/90 text-white border border-emerald-500 hover:bg-emerald-600",children:[t.jsx(_e,{className:"w-4 h-4"})," WhatsApp"]}),t.jsx("button",{onClick:de,className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold bg-slate-800/70 text-white border border-slate-700 hover:bg-slate-800",children:"Download Poster"}),t.jsx("button",{onClick:async()=>{const s=(h==null?void 0:h.referral_code)||((b==null?void 0:b.id)||"").replace(/-/g,"").slice(0,8),a=/iPhone|iPad|iPod/i.test(navigator.userAgent),r=["ðŸ”¥ My result is here! ðŸ”¥","Checked out the poster? Now itâ€™s your turn ðŸ‘€","","ðŸ‘‰ Just head over to www.quizdangal.com",`Use Referral Code: ${s}`,"and unlock your score ðŸš€","","Donâ€™t just scroll, share your vibes ðŸ’¯","#Results #ChallengeAccepted"].join(`
`),o=`My result on Quiz Dangal â€” Use code: ${s} â€” quizdangal.com`;try{await navigator.clipboard.writeText(a?o:r)}catch(l){}T({title:"Caption copied",description:"Paste it in the app if needed."})},className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold bg-slate-800/70 text-white border border-slate-700 hover:bg-slate-800",children:"Copy Caption"}),t.jsxs("button",{onClick:ie,className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-extrabold border text-white shadow-[0_8px_18px_rgba(139,92,246,0.4)] hover:shadow-[0_12px_24px_rgba(139,92,246,0.55)] border-violet-500/40 bg-[linear-gradient(90deg,#4f46e5,#7c3aed,#9333ea,#c026d3)]",children:[t.jsx(Ce,{className:"w-4 h-4"})," Share"]})]})]})]})})};export{Ee as default};
